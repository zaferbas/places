<!doctype html> <html> <head> <meta content="IE=edge" http-equiv=X-UA-Compatible> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name=viewport> <!--[if IE]><link rel="shortcut icon" href="images/favicon-4989dd00.png"><![endif]--> <link rel=icon href="images/favicon-4989dd00.png"> <meta content="IE=edge,chrome=1" http-equiv=X-UA-Compatible> <meta content=summary_large_image name='twitter:card'> <meta content='Algolia Places' name='twitter:site'> <meta content='@Algolia' name='twitter:creator'> <meta content="Autocompletion within search is essential for user experience and address search functionality. Learn how Algolia Places increases both with speed and ease." name="twitter:description"> <meta content="https://res.cloudinary.com/hilnmyskv/image/upload/v1466000434/places-og-image_jp9phw.png" name="twitter:image"> <meta content='https://community.algolia.com/places/' property='og:url'> <meta content='Algolia Places' property='og:title'> <meta content='https://res.cloudinary.com/hilnmyskv/image/upload/v1466000434/places-og-image_jp9phw.png' property='og:image'> <meta content='Autocompletion within search is essential for user experience and address search functionality. Learn how Algolia Places increases both with speed and ease.' property='og:description'> <meta content='Algolia Places' property='og:site_name'> <title>Algolia Places | Examples</title> <link rel=stylesheet href="https://cdn.jsdelivr.net/hint.css/2/hint.min.css"/> <link rel=stylesheet media=screen href="//fonts.googleapis.com/css?family=Raleway:300,800"> <link href="stylesheets/site-158292da.css" rel=stylesheet /> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
      var currentPath = 'examples.html';
      var clippyPath = 'images/clippy-386f5330.svg';
    </script> </head> <body class=examples> <div class=ac-nav> <div class=ac-nav-container> <div class=ac-nav-brand> <a class=ac-logo href='https://community.algolia.com/' title='Algolia Community'> <img alt='Algolia Community' class='ac-logo__lg nav-icon' src='https://res.cloudinary.com/hilnmyskv/image/upload/v1484217596/algolia-community-logo-darkbg.svg' width=150> <img alt='Algolia Community' class='ac-logo__sm community-badge' src='images/svg/logo-community-fcccfd2c.svg'> </a> <span class=ac-nav-brand-breadcrumb></span> <a class=ac-nav-brand-title data-path='index.html' href='./' title=Home>Places</a> </div> <div class=ac-nav-menu> <div class=ac-nav-searchbox> <form class=searchbox id=docsearch-form novalidate=novalidate onsubmit='return false;' style='visibility:hidden;height:0'> <div class=searchbox__wrapper role=search> <input autocomplete=off class=searchbox__input id=docsearch name=search placeholder='Search in the doc' required=required type=search> <button class=searchbox__submit title='Submit your search query.' type=submit> <svg aria-label=Search role=img> <use xlink:href='#sbx-icon-search-13' xmlns:xlink='http://www.w3.org/1999/xlink'></use> </svg> </button> <button class='searchbox__reset hide' title='Clear the search query.' type=reset> <svg aria-label=Reset role=img> <use xlink:href='#sbx-icon-clear-3' xmlns:xlink='http://www.w3.org/1999/xlink'></use> </svg> </button> </input> </div> </form> <div class=svg-icons style='height: 0; width: 0; position: absolute; visibility: hidden'> <svg xmlns='http://www.w3.org/2000/svg'> <symbol id=sbx-icon-clear-3 viewBox="0 0 40 40"><path d="M16.228 20L1.886 5.657 0 3.772 3.772 0l1.885 1.886L20 16.228 34.343 1.886 36.228 0 40 3.772l-1.886 1.885L23.772 20l14.342 14.343L40 36.228 36.228 40l-1.885-1.886L20 23.772 5.657 38.114 3.772 40 0 36.228l1.886-1.885L16.228 20z" fill-rule=evenodd /></symbol> <symbol id=sbx-icon-search-13 viewBox="0 0 12 12"><path d="M12 11.077c0-.245-.1-.483-.267-.65L9.26 7.955c.584-.843.894-1.853.894-2.877C10.154 2.272 7.882 0 5.077 0S0 2.272 0 5.077s2.272 5.077 5.077 5.077c1.024 0 2.034-.31 2.877-.894l2.474 2.466c.166.173.404.274.65.274.504 0 .922-.418.922-.923zm-3.692-6c0 1.78-1.45 3.23-3.23 3.23-1.782 0-3.232-1.45-3.232-3.23s1.45-3.23 3.23-3.23c1.782 0 3.232 1.45 3.232 3.23z" fill="#FFF" fill-rule=evenodd opacity="0.85"/></symbol> </svg> </div> </div> <ul class=ac-nav-menu-list> <li class=ac-nav-menu-list-item> <a data-path='documentation.html' href='documentation.html' title=Documentation>Documentation</a> </li> <li class=ac-nav-menu-list-item> <a data-path='api-clients.html' href='api-clients.html' title='API Clients'>API Clients</a> </li> <li class='ac-nav-menu-list-item active'> <a data-path='examples.html' href='examples.html' title=Examples>Examples</a> </li> <li class=ac-nav-menu-list-item> <a data-path='pricing.html' href='pricing.html' title=Pricing>Pricing</a> </li> <li class=ac-nav-menu-list-item> <a data-path='status.html' href='status.html' title=Status>Status</a> </li> <li class=ac-nav-menu-list-item> <a data-path='support.html' href='support.html' title=Support>Support</a> </li> <li class=ac-nav-menu-list-item> <a data-path='contact.html' href='contact.html' title=Contact>Contact</a> </li> <li class=ac-nav-menu-list-icon> <a class=ac-icon href='https://github.com/algolia/places' title='GitHub repository'> <span class='ac-icon ac-icon-github'></span> </a> </li> </ul> </div> </div> </div> <section class='hero-section shrink'> <div class=container> <div class=hero-container> <div class=fl-left> <a href='https://www.algolia.com/?utm_medium=social-owned&amp;utm_source=places%20website&amp;utm_campaign=homepage' title='Algolia built this'> <span class='icon icon-algolia-small no-mobile' id=icon-algolia></span> </a> <span class='display-on-small small-illustration'> <img src='images/svg/places-illustration-65745839.svg'> </span> <h1>Examples</h1> </div> </div> </div> <div class=relative> <div id=json-response> <div id=json-response-text></div> <div id=json-response-timing></div> </div> </div> <div class=examples-intro> <div class=items-holder> <div class=item> <a href='#simple-input'> <span class='square input'> <?xml version="1.0" encoding=UTF-8 standalone=no?> <svg width=48px height=48px viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>search-icon</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=Page-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=Places-1-Copy-9 transform="translate(-289.000000, -310.000000)" fill="#FFFFFF"> <g id=Group-20 transform="translate(253.000000, 274.000000)"> <path d="M70.3053173,66.1886792 L68.1372213,66.1886792 L67.3687822,65.4476844 C70.058319,62.3190395 71.67753,58.2572899 71.67753,53.838765 C71.67753,43.9862779 63.6912521,36 53.838765,36 C43.9862779,36 36,43.9862779 36,53.838765 C36,63.6912521 43.9862779,71.67753 53.838765,71.67753 C58.2572899,71.67753 62.3190395,70.058319 65.4476844,67.3687822 L66.1886792,68.1372213 L66.1886792,70.3053173 L79.9108062,84 L84,79.9108062 L70.3053173,66.1886792 L70.3053173,66.1886792 Z M53.838765,66.1886792 C47.0051458,66.1886792 41.4888508,60.6723842 41.4888508,53.838765 C41.4888508,47.0051458 47.0051458,41.4888508 53.838765,41.4888508 C60.6723842,41.4888508 66.1886792,47.0051458 66.1886792,53.838765 C66.1886792,60.6723842 60.6723842,66.1886792 53.838765,66.1886792 L53.838765,66.1886792 Z" id=search-icon></path> </g> </g> </g> </svg> </span> <span class=name>Simple Input</span> </a> </div> <div class=item> <a href='#complete-form'> <span class='square form'> <?xml version="1.0" encoding=UTF-8 standalone=no?> <svg width=39px height=48px viewBox="0 0 39 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>form-icon</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=Page-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=Places-1-Copy-9 transform="translate(-458.000000, -310.000000)" fill="#FFFFFF"> <g id=Group-20 transform="translate(253.000000, 274.000000)"> <path d="M241.048649,83.8933333 L207.424324,83.8933333 C206.106757,83.8933333 205,82.7733333 205,81.44 L205,38.4533333 C205,37.12 206.106757,36 207.424324,36 L241.048649,36 C242.366216,36 243.472973,37.12 243.472973,38.4533333 L243.472973,81.44 C243.472973,82.8266667 242.366216,83.8933333 241.048649,83.8933333 L241.048649,83.8933333 Z M209.47973,79.7333333 L238.993243,79.7333333 C239.204054,79.7333333 239.362162,79.5733333 239.362162,79.36 L239.362162,40.5333333 C239.362162,40.32 239.204054,40.16 238.993243,40.16 L209.47973,40.16 C209.268919,40.16 209.110811,40.32 209.110811,40.5333333 L209.110811,79.36 C209.058108,79.5733333 209.268919,79.7333333 209.47973,79.7333333 Z M233.406757,75.2 L215.013514,75.2 C214.802703,75.2 214.644595,75.04 214.644595,74.8266667 L214.644595,71.4666667 C214.644595,71.2533333 214.802703,71.0933333 215.013514,71.0933333 L233.406757,71.0933333 C233.617568,71.0933333 233.775676,71.2533333 233.775676,71.4666667 L233.775676,74.8266667 C233.828378,75.04 233.617568,75.2 233.406757,75.2 Z M233.406757,66.4 L215.013514,66.4 C214.802703,66.4 214.644595,66.24 214.644595,66.0266667 L214.644595,62.6666667 C214.644595,62.4533333 214.802703,62.2933333 215.013514,62.2933333 L233.406757,62.2933333 C233.617568,62.2933333 233.775676,62.4533333 233.775676,62.6666667 L233.775676,66.0266667 C233.828378,66.24 233.617568,66.4 233.406757,66.4 Z M233.406757,57.6 L215.013514,57.6 C214.802703,57.6 214.644595,57.44 214.644595,57.2266667 L214.644595,53.8666667 C214.644595,53.6533333 214.802703,53.4933333 215.013514,53.4933333 L233.406757,53.4933333 C233.617568,53.4933333 233.775676,53.6533333 233.775676,53.8666667 L233.775676,57.2266667 C233.828378,57.44 233.617568,57.6 233.406757,57.6 Z M233.406757,48.8533333 L215.013514,48.8533333 C214.802703,48.8533333 214.644595,48.6933333 214.644595,48.48 L214.644595,45.12 C214.644595,44.9066667 214.802703,44.7466667 215.013514,44.7466667 L233.406757,44.7466667 C233.617568,44.7466667 233.775676,44.9066667 233.775676,45.12 L233.775676,48.48 C233.828378,48.6933333 233.617568,48.8533333 233.406757,48.8533333 Z" id=form-icon></path> </g> </g> </g> </svg> </span> <span class=name>Complete Form</span> </a> </div> <div class=item> <a href='#city-search'> <span class='square city'> <?xml version="1.0" encoding=UTF-8 standalone=no?> <svg width=48px height=51px viewBox="0 0 48 51" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>city-icon</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=Page-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=Places-1-Copy-9 transform="translate(-617.000000, -308.000000)" fill="#FFFFFF"> <g id=Group-20 transform="translate(253.000000, 274.000000)"> <path d="M396,58.1578947 L396,42.0526316 L388,34 L380,42.0526316 L380,47.4210526 L364,47.4210526 L364,85 L412,85 L412,58.1578947 L396,58.1578947 L396,58.1578947 Z M374.666667,79.6315789 L369.333333,79.6315789 L369.333333,74.2631579 L374.666667,74.2631579 L374.666667,79.6315789 L374.666667,79.6315789 Z M374.666667,68.8947368 L369.333333,68.8947368 L369.333333,63.5263158 L374.666667,63.5263158 L374.666667,68.8947368 L374.666667,68.8947368 Z M374.666667,58.1578947 L369.333333,58.1578947 L369.333333,52.7894737 L374.666667,52.7894737 L374.666667,58.1578947 L374.666667,58.1578947 Z M390.666667,79.6315789 L385.333333,79.6315789 L385.333333,74.2631579 L390.666667,74.2631579 L390.666667,79.6315789 L390.666667,79.6315789 Z M390.666667,68.8947368 L385.333333,68.8947368 L385.333333,63.5263158 L390.666667,63.5263158 L390.666667,68.8947368 L390.666667,68.8947368 Z M390.666667,58.1578947 L385.333333,58.1578947 L385.333333,52.7894737 L390.666667,52.7894737 L390.666667,58.1578947 L390.666667,58.1578947 Z M390.666667,47.4210526 L385.333333,47.4210526 L385.333333,42.0526316 L390.666667,42.0526316 L390.666667,47.4210526 L390.666667,47.4210526 Z M406.666667,79.6315789 L401.333333,79.6315789 L401.333333,74.2631579 L406.666667,74.2631579 L406.666667,79.6315789 L406.666667,79.6315789 Z M406.666667,68.8947368 L401.333333,68.8947368 L401.333333,63.5263158 L406.666667,63.5263158 L406.666667,68.8947368 L406.666667,68.8947368 Z" id=city-icon></path> </g> </g> </g> </svg> </span> <span class=name>City Search</span> </a> </div> <div class=item> <a href='#country-search'> <span class='square country'> <?xml version="1.0" encoding=UTF-8 standalone=no?> <svg width=48px height=48px viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>country-icon</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=Page-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=Places-1-Copy-9 transform="translate(-781.000000, -310.000000)" fill="#FFFFFF"> <g id=Group-20 transform="translate(253.000000, 274.000000)"> <path d="M552,36 C538.752,36 528,46.752 528,60 C528,73.248 538.752,84 552,84 C565.248,84 576,73.248 576,60 C576,46.752 565.248,36 552,36 L552,36 Z M549.6,79.032 C540.12,77.856 532.8,69.792 532.8,60 C532.8,58.512 532.992,57.096 533.304,55.704 L544.8,67.2 L544.8,69.6 C544.8,72.24 546.96,74.4 549.6,74.4 L549.6,79.032 L549.6,79.032 Z M566.16,72.936 C565.536,70.992 563.76,69.6 561.6,69.6 L559.2,69.6 L559.2,62.4 C559.2,61.08 558.12,60 556.8,60 L542.4,60 L542.4,55.2 L547.2,55.2 C548.52,55.2 549.6,54.12 549.6,52.8 L549.6,48 L554.4,48 C557.04,48 559.2,45.84 559.2,43.2 L559.2,42.216 C566.232,45.072 571.2,51.96 571.2,60 C571.2,64.992 569.28,69.528 566.16,72.936 L566.16,72.936 Z" id=country-icon></path> </g> </g> </g> </svg> </span> <span class=name>Country Search</span> </a> </div> <div class=item> <a href='#displaying-on-a-map'> <span class='square map'> <?xml version="1.0" encoding=UTF-8 standalone=no?> <svg width=34px height=48px viewBox="0 0 34 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>map-icon</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=Page-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=Places-1-Copy-9 transform="translate(-952.000000, -310.000000)" fill="#FFFFFF"> <g id=Group-20 transform="translate(253.000000, 274.000000)"> <path d="M716,36 C706.601429,36 699,43.512 699,52.8 C699,65.4 716,84 716,84 C716,84 733,65.4 733,52.8 C733,43.512 725.398571,36 716,36 L716,36 Z M716,58.8 C712.648571,58.8 709.928571,56.112 709.928571,52.8 C709.928571,49.488 712.648571,46.8 716,46.8 C719.351429,46.8 722.071429,49.488 722.071429,52.8 C722.071429,56.112 719.351429,58.8 716,58.8 L716,58.8 Z" id=map-icon></path> </g> </g> </g> </svg> </span> <span class=name>Link to a map</span> </a> </div> <div class=item> <a href='#advanced'> <span class='square advanced'> <?xml version="1.0" encoding=UTF-8 standalone=no?> <svg width=48px height=48px viewBox="0 0 48 48" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>advanced-icon</title> <desc>Created with Sketch.</desc> <defs></defs> <g id=Page-1 stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=Places-1-Copy-9 transform="translate(-1109.000000, -310.000000)" fill="#FFFFFF"> <g id=Group-20 transform="translate(253.000000, 274.000000)"> <path d="M899.549491,62.857438 L904,60.9845041 C903.739664,57.9834711 903.749995,58.1022727 903.490692,55.1012397 L898.783979,54.0206612 C897.930654,52.1859504 897.571143,51.4142562 896.717818,49.5795455 L898.923444,45.2840909 C896.795299,43.1518595 896.880012,43.2365702 894.751867,41.1043388 L890.449089,43.302686 C888.616404,42.446281 887.844694,42.0857438 886.01201,41.2293388 L884.939672,36.5196281 C881.939608,36.2541322 882.057379,36.2644628 879.057314,36 L877.175043,40.4493802 C875.220455,40.9710744 874.398123,41.1911157 872.443536,41.7128099 L868.593246,38.7933884 C866.124185,40.5196281 866.222327,40.4514463 863.753266,42.1766529 L865.170652,46.7923554 C864.008437,48.4483471 863.51979,49.1456612 862.357575,50.8016529 L857.533091,51.0402893 C856.751049,53.9493802 856.782042,53.8336777 856,56.7427686 L860.052773,59.3667355 C860.227364,61.3822314 860.300712,62.2303719 860.475303,64.2469008 L856.933904,67.5289256 C858.204593,70.2603306 858.153972,70.1518595 859.42466,72.8832645 L864.218152,72.2882231 C865.646902,73.7200413 866.249188,74.322314 867.677937,75.7541322 L867.074619,80.5454545 C869.802983,81.821281 869.695543,81.7706612 872.423907,83.0464876 L875.7153,79.5092975 C877.729807,79.6869835 878.578998,79.7623967 880.593505,79.9400826 L883.213396,84 C886.123582,83.2231405 886.00891,83.2530992 888.919097,82.4762397 L889.166003,77.6528926 C890.824097,76.4938017 891.522459,76.0061983 893.180552,74.8471074 L897.796354,76.2727273 C899.52573,73.8068182 899.457547,73.9039256 901.187956,71.4380165 L898.276736,67.5857438 C898.802574,65.6332645 899.023653,64.8109504 899.549491,62.857438 L899.549491,62.857438 Z M880.335234,72.5847107 C873.20285,72.5847107 867.421733,66.803719 867.421733,59.6714876 C867.421733,52.5392562 873.20285,46.7582645 880.335234,46.7582645 C887.467619,46.7582645 893.248736,52.5392562 893.248736,59.6714876 C893.248736,66.803719 887.467619,72.5847107 880.335234,72.5847107 L880.335234,72.5847107 Z" id=advanced-icon></path> </g> </g> </g> </svg> </span> <span class=name>Advanced</span> </a> </div> </div> </div> </section> <section class=documentation-section> <div class=container> <nav class=sidebar id=sidebar></nav> <div class=documentation-container> <link rel=stylesheet href="https://cdn.jsdelivr.net/instantsearch.js/2.10.1/instantsearch.min.css"/> <link rel=stylesheet href="https://cdn.jsdelivr.net/instantsearch.js/2.10.1/instantsearch-theme-algolia.min.css"/> <link rel=stylesheet href="https://cdn.jsdelivr.net/leaflet/1/leaflet.css"/> <script src="https://cdn.jsdelivr.net/leaflet/1/leaflet.js"></script> <h2 id=rendering>Rendering</h2> <h3 id=simple-input>Simple input</h3> <p>In this section, we will see how places.js turns any HTML <code>&lt;input&gt;</code> into an autocomplete address search bar.</p> <p><input type=search id=address class=form-control placeholder="Where are we going?"/></p> <p>Selected: <strong id=address-value>none</strong></p> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#address')
  });

  var $address = document.querySelector('#address-value')
  placesAutocomplete.on('change', function(e) {
    $address.textContent = e.suggestion.value
  });

  placesAutocomplete.on('clear', function() {
    $address.textContent = 'none';
  });

})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class=rouge-code><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"address"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;p&gt;</span>Selected: <span class="nt">&lt;strong</span> <span class="na">id=</span><span class="s">"address-value"</span><span class="nt">&gt;</span>none<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#address'</span><span class="p">)</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$address</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#address-value'</span><span class="p">)</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$address</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">value</span>
  <span class="p">});</span>

  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'clear'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$address</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'none'</span><span class="p">;</span>
  <span class="p">});</span>

<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p>You should consider using this snippet when you want your users to easily find their addresses, and have it presented in a good and reliable format.</p> <h3 id=complete-form>Complete form</h3> <p>In this section, we will see how you can interact with Places in order to fill in a complete address form.</p> <p>Having an address autocomplete offers great user experience, but if the address is meant to be processed internally or used for shipping, you may have to reformat or access parts of the address, which can be cumbersome when reading an already formatted address.</p> <p>In order to help you with this, Places.js emits a <a href="documentation.html#events">change event</a> when a user selects an address from its dropdown. The event includes the selected address, also called a <a href="documentation#suggestions">suggestion</a>, in a structured format, which can then be used to populate other fields. You can learn more about the suggestion object in the <a href="documentation#suggestions">documentation</a>.</p> <form action="/billing" class=form> <div class=form-group> <label for=form-address>Address*</label> <input type=search class=form-control id=form-address placeholder="Where do you live?"/> </div> <div class=form-group> <label for=form-address2>Address 2</label> <input class=form-control id=form-address2 placeholder="Street number and name"/> </div> <div class=form-group> <label for=form-city>City*</label> <input class=form-control id=form-city placeholder=City /> </div> <div class=form-group> <label for=form-zip>ZIP code*</label> <input class=form-control id=form-zip placeholder="ZIP code"/> </div> </form> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#form-address'),
    templates: {
      value: function(suggestion) {
        return suggestion.name;
      }
    }
  }).configure({
    type: 'address'
  });
  placesAutocomplete.on('change', function resultSelected(e) {
    document.querySelector('#form-address2').value = e.suggestion.administrative || '';
    document.querySelector('#form-city').value = e.suggestion.city || '';
    document.querySelector('#form-zip').value = e.suggestion.postcode || '';
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class=rouge-code><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/billing"</span> <span class="na">class=</span><span class="s">"form"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form-address"</span><span class="nt">&gt;</span>Address*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"form-address"</span> <span class="na">placeholder=</span><span class="s">"Where do you live?"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form-address2"</span><span class="nt">&gt;</span>Address 2<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"form-address2"</span> <span class="na">placeholder=</span><span class="s">"Street number and name"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form-city"</span><span class="nt">&gt;</span>City*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"form-city"</span> <span class="na">placeholder=</span><span class="s">"City"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"form-zip"</span><span class="nt">&gt;</span>ZIP code*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"form-zip"</span> <span class="na">placeholder=</span><span class="s">"ZIP code"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#form-address'</span><span class="p">),</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">value</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'address'</span>
  <span class="p">});</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">resultSelected</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#form-address2'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">administrative</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#form-city'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#form-zip'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">postcode</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p>This template can be used as a helper for shipping forms.</p> <p><strong>Note:</strong> This template intercepts the suggestion from the <code>change</code> event and updates other <code>&lt;input&gt;</code> fields, so that the user can then validate and/or modify the data if it is needed. This is considered a best practice because Places addresses can sometimes be incorrect or incomplete: new streets are built all the time; cities are sometimes renamed; or simply because the underlying OpenStreetMap data is not perfect in all areas. Therefore, you should not use the suggestion data without allowing the end user the possibility to modify the address.</p> <p><strong>Note:</strong> There are some challenges with address forms that have not been addressed in this example for the sake of simplicity. For instance, in some countries, there can be multiple postal codes for a single city, and you should then use a dropdown with the possible values provided in the suggestion, while still allowing the user to correct it if needed.</p> <h3 id=displaying-on-a-map>Displaying on a map</h3> <p>We will use the <a href="http://leafletjs.com/">Leaflet</a> JavaScript library as an example to display the places.js results on the map and update them when needed.</p> <div id=map-example-container></div> <p><input type=search id=input-map class=form-control placeholder="Where are we going?"/></p> <style>
  #map-example-container {height: 300px};
</style> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#input-map')
  });

  var map = L.map('map-example-container', {
    scrollWheelZoom: false,
    zoomControl: false
  });

  var osmLayer = new L.TileLayer(
    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      minZoom: 1,
      maxZoom: 13,
      attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
    }
  );

  var markers = [];

  map.setView(new L.LatLng(0, 0), 1);
  map.addLayer(osmLayer);

  placesAutocomplete.on('suggestions', handleOnSuggestions);
  placesAutocomplete.on('cursorchanged', handleOnCursorchanged);
  placesAutocomplete.on('change', handleOnChange);
  placesAutocomplete.on('clear', handleOnClear);

  function handleOnSuggestions(e) {
    markers.forEach(removeMarker);
    markers = [];

    if (e.suggestions.length === 0) {
      map.setView(new L.LatLng(0, 0), 1);
      return;
    }

    e.suggestions.forEach(addMarker);
    findBestZoom();
  }

  function handleOnChange(e) {
    markers
      .forEach(function(marker, markerIndex) {
        if (markerIndex === e.suggestionIndex) {
          markers = [marker];
          marker.setOpacity(1);
          findBestZoom();
        } else {
          removeMarker(marker);
        }
      });
  }

  function handleOnClear() {
    map.setView(new L.LatLng(0, 0), 1);
    markers.forEach(removeMarker);
  }

  function handleOnCursorchanged(e) {
    markers
      .forEach(function(marker, markerIndex) {
        if (markerIndex === e.suggestionIndex) {
          marker.setOpacity(1);
          marker.setZIndexOffset(1000);
        } else {
          marker.setZIndexOffset(0);
          marker.setOpacity(0.5);
        }
      });
  }

  function addMarker(suggestion) {
    var marker = L.marker(suggestion.latlng, {opacity: .4});
    marker.addTo(map);
    markers.push(marker);
  }

  function removeMarker(marker) {
    map.removeLayer(marker);
  }

  function findBestZoom() {
    var featureGroup = L.featureGroup(markers);
    map.fitBounds(featureGroup.getBounds().pad(0.5), {animate: false});
  }
})();
</script> <p>To try this example, you need to add leaflet in your code:</p> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class=rouge-code><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://cdn.jsdelivr.net/leaflet/1/leaflet.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/leaflet/1/leaflet.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p>Then use this:</p> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre></td><td class=rouge-code><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map-example-container"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"input-map"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;style&gt;</span>
  <span class="nf">#map-example-container</span> <span class="p">{</span><span class="nl">height</span><span class="p">:</span> <span class="m">300px</span><span class="p">}</span><span class="o">;</span>
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#input-map'</span><span class="p">)</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">'map-example-container'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">scrollWheelZoom</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">zoomControl</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">osmLayer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">TileLayer</span><span class="p">(</span>
    <span class="s1">'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">minZoom</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">maxZoom</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
      <span class="na">attribution</span><span class="p">:</span> <span class="s1">'Map data © &lt;a href="https://openstreetmap.org"&gt;OpenStreetMap&lt;/a&gt; contributors'</span>
    <span class="p">}</span>
  <span class="p">);</span>

  <span class="kd">var</span> <span class="nx">markers</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">(</span><span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
  <span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">osmLayer</span><span class="p">);</span>

  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'suggestions'</span><span class="p">,</span> <span class="nx">handleOnSuggestions</span><span class="p">);</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'cursorchanged'</span><span class="p">,</span> <span class="nx">handleOnCursorchanged</span><span class="p">);</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">handleOnChange</span><span class="p">);</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'clear'</span><span class="p">,</span> <span class="nx">handleOnClear</span><span class="p">);</span>

  <span class="kd">function</span> <span class="nx">handleOnSuggestions</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">removeMarker</span><span class="p">);</span>
    <span class="nx">markers</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">suggestions</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">(</span><span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">e</span><span class="p">.</span><span class="nx">suggestions</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">addMarker</span><span class="p">);</span>
    <span class="nx">findBestZoom</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">handleOnChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markers</span>
      <span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">marker</span><span class="p">,</span> <span class="nx">markerIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">markerIndex</span> <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestionIndex</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">markers</span> <span class="o">=</span> <span class="p">[</span><span class="nx">marker</span><span class="p">];</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
          <span class="nx">findBestZoom</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">removeMarker</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">handleOnClear</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">(</span><span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
    <span class="nx">markers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">removeMarker</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">handleOnCursorchanged</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markers</span>
      <span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">marker</span><span class="p">,</span> <span class="nx">markerIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">markerIndex</span> <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestionIndex</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setZIndexOffset</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setZIndexOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">addMarker</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">latlng</span><span class="p">,</span> <span class="p">{</span><span class="na">opacity</span><span class="p">:</span> <span class="p">.</span><span class="mi">4</span><span class="p">});</span>
    <span class="nx">marker</span><span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
    <span class="nx">markers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">removeMarker</span><span class="p">(</span><span class="nx">marker</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">removeLayer</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">findBestZoom</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">featureGroup</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">featureGroup</span><span class="p">(</span><span class="nx">markers</span><span class="p">);</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">fitBounds</span><span class="p">(</span><span class="nx">featureGroup</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">().</span><span class="nx">pad</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="p">{</span><span class="na">animate</span><span class="p">:</span> <span class="kc">false</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <h3 id=templates>Templates</h3> <p><strong>Warning:</strong> This is an advanced feature.</p> <p>Although Places.js comes with a good default template that should fit most use cases, you may want to customize both the input value and dropdown suggestion templates to better fit your needs.</p> <p>In order to help you modify the rendered values for both objects, Places exposes a <a href="documentation.html#api-options-templates">templates option</a> that can be configured for both the <code>value</code> and <code>suggestion</code> components.</p> <p>Templates are functions called with a <a href="documentation.html#suggestions">suggestion object</a>.</p> <p><input type=search id=address-templates class=form-control placeholder="Where are we going?"/></p> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#address-templates'),
    templates: {
      value: function(suggestion) {
        return 'Maybe ' + suggestion.name + ' in ' + suggestion.country + '?';
      },
      suggestion: function(suggestion) {
        return '<u>Click here to select ' + suggestion.name + ' from ' + suggestion.country + '</u>';
      }
    }
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class=rouge-code><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"address-templates"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#address-templates'</span><span class="p">),</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">value</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'Maybe '</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">' in '</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">country</span> <span class="o">+</span> <span class="s1">'?'</span><span class="p">;</span>
      <span class="p">},</span>
      <span class="na">suggestion</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'&lt;u&gt;Click here to select '</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">' from '</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">country</span> <span class="o">+</span> <span class="s1">'&lt;/u&gt;'</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <h3 id=disable-styling>Disable styling</h3> <p><strong>Warning:</strong> This is an advanced feature.</p> <p>The default Algolia Places styling can be enhanced by overriding the <a href="documentation.html#styling">default rules</a>.</p> <p>If you need full control and want to disable all default styling, you can do it by setting the <code>style</code> option to false.</p> <div id=input-styling-address> <input type=search placeholder="Where are we going?"/> </div> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <style>
#input-styling-address input {
  display: inline-block;
  border: 1px solid #d9d9d9;
  border-radius: 12px;
  background: #ffffff;
  padding: 1em 0 1em 45px;
  width: 100%;
}

#input-styling-address input:focus, #input-styling-address input:active {
  outline: 0;
  border-color: #aaaaaa;
  background: #ffffff;
}

#input-styling-address .ap-nostyle-dropdown-menu {
  box-shadow: none;
  border: 1px solid #dadada;
  border-radius: 0;
  background: #fff;
  width: 100%;
}

#input-styling-address .ap-nostyle-input-icon {
  display: block;
  position: absolute;
  background: none;
  border: none;
}

#input-styling-address .algolia-places-nostyle { width: 50%; }
#input-styling-address .ap-nostyle-icon-pin { left: 5px;top: 10px; }
#input-styling-address .ap-nostyle-icon-clear { right: 5px;top: 15px }
#input-styling-address input:hover { border-color: silver; }
#input-styling-address input::placeholder { color: #aaaaaa; }
#input-styling-address .ap-nostyle-suggestion { border-bottom: 1px solid #efefef; }
</style> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#input-styling-address input'),
    style: false,
    debug: true
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class=rouge-code><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"input-styling-address"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
<span class="nf">#input-styling-address</span> <span class="nt">input</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#d9d9d9</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">12px</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">1em</span> <span class="m">0</span> <span class="m">1em</span> <span class="m">45px</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#input-styling-address</span> <span class="nt">input</span><span class="nd">:focus</span><span class="o">,</span> <span class="nf">#input-styling-address</span> <span class="nt">input</span><span class="nd">:active</span> <span class="p">{</span>
  <span class="nl">outline</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">border-color</span><span class="p">:</span> <span class="m">#aaaaaa</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#input-styling-address</span> <span class="nc">.ap-nostyle-dropdown-menu</span> <span class="p">{</span>
  <span class="nl">box-shadow</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#dadada</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#input-styling-address</span> <span class="nc">.ap-nostyle-input-icon</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#input-styling-address</span> <span class="nc">.algolia-places-nostyle</span> <span class="p">{</span> <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span> <span class="p">}</span>
<span class="nf">#input-styling-address</span> <span class="nc">.ap-nostyle-icon-pin</span> <span class="p">{</span> <span class="nl">left</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span><span class="nl">top</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span> <span class="p">}</span>
<span class="nf">#input-styling-address</span> <span class="nc">.ap-nostyle-icon-clear</span> <span class="p">{</span> <span class="nl">right</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span><span class="nl">top</span><span class="p">:</span> <span class="m">15px</span> <span class="p">}</span>
<span class="nf">#input-styling-address</span> <span class="nt">input</span><span class="nd">:hover</span> <span class="p">{</span> <span class="nl">border-color</span><span class="p">:</span> <span class="no">silver</span><span class="p">;</span> <span class="p">}</span>
<span class="nf">#input-styling-address</span> <span class="nt">input</span><span class="nd">::placeholder</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span> <span class="m">#aaaaaa</span><span class="p">;</span> <span class="p">}</span>
<span class="nf">#input-styling-address</span> <span class="nc">.ap-nostyle-suggestion</span> <span class="p">{</span> <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#efefef</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#input-styling-address input'</span><span class="p">),</span>
    <span class="na">style</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">debug</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p>See our <a href="documentation.html#styling">documentation about styling</a> for more details.</p> <p><strong>Important:</strong> Regardless of how you want to style your results, your updated styles must still be compliant with our <a href="documentation.html#licenses--policies">Usage Policy</a> and must display the Algolia Logo.</p> <h2 id=focusing-search>Focusing search</h2> <p>Places offers many ways to restrict the scope of its search to either certain types of records, certain countries, or even certain locations.</p> <p>In this section, we will explore how we can use these restrictions to improve the relevance to best match the end user expectations.</p> <h3 id=city-search>City search</h3> <p><strong>Concept:</strong> <a href="documentation.html#api-options-type">type</a> parameter.</p> <p>In this section, we will see how you can restrict the scope of Places to only a certain type.</p> <p>There are many use-cases where having a full blown address search is not necessary, and simply searching for a city is enough.</p> <p>In order to help you with this, Places.js exposes a configuration parameter to restrict the type of records you want to search against. You can build a city search input by using the <a href="documentation.html#api-options-type">type parameter</a>.</p> <p><input type=search id=city class=form-control placeholder="In which city do you live?"/></p> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#city'),
    templates: {
      value: function(suggestion) {
        return suggestion.name;
      }
    }
  }).configure({
    type: 'city',
    aroundLatLngViaIP: false,
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class=rouge-code><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"city"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"In which city do you live?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#city'</span><span class="p">),</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">value</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'city'</span><span class="p">,</span>
    <span class="na">aroundLatLngViaIP</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p><strong>Note:</strong> It is possible to restrict the type of records to more than a single type by passing an array of types that you want to search against. For instance, you can combine the <code>city</code> type with the <code>airport</code> type. However, be careful when searching for cities and other types at the same time. Due to the fact that cities are prioritized in the ranking, other types of records can be pushed back and have difficulties appearing in the results.</p> <h3 id=country-search>Country search</h3> <p>You can also search in countries only.</p> <p>places.js turns any HTML <code>&lt;input&gt;</code> into a Country as-you-type search bar. You can filter on a specific list of countries if needed:</p> <link rel=stylesheet href="//github.com/downloads/lafeber/world-flags-sprite/flags16.css"/> <div class=f16> <input type=search id=country class=form-control placeholder="What's your favorite country?"/> </div> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#country'),
    templates: {
      suggestion: function(suggestion) {
        return '<i class="flag ' + suggestion.countryCode + '"></i> ' +
          suggestion.highlight.name;
      }
    }
  }).configure({
    type: 'country',
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class=rouge-code><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"//github.com/downloads/lafeber/world-flags-sprite/flags16.css"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"f16"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"country"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"What's your favorite country?"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#country'</span><span class="p">),</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">suggestion</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'&lt;i class="flag '</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">countryCode</span> <span class="o">+</span> <span class="s1">'"&gt;&lt;/i&gt; '</span> <span class="o">+</span>
          <span class="nx">suggestion</span><span class="p">.</span><span class="nx">highlight</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'country'</span><span class="p">,</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <h3 id=searching-in-a-country>Searching in a country</h3> <p><strong>Concept:</strong> <a href="documentation.html#api-options-countries">countries</a> parameter.</p> <p>In this section, we will see how you can restrict the scope of Places to search only in some countries.</p> <p>Places.js exposes a <a href="documentation.html#api-options-countries">countries parameter</a> will restrict the search to records that belong to this array of countries. For instance, if you want to restrict the search to records in France:</p> <div class=dynamic-control-group style="max-width: 240px"> <label for=country-selector>Select country</label> <select id=country-selector class="btn btn-black"> <option value=fr>France</option> <option value=us>United States</option> </select> </div> <p><input type=search id=single-country-search class=form-control placeholder="Where are we going?"/></p> <p>Selected: <strong id=single-country-address-value>none</strong></p> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#single-country-search')
  }).configure({
    countries: ['fr']
  });

  var $address = document.querySelector('#single-country-address-value')
  placesAutocomplete.on('change', function(e) {
    $address.textContent = e.suggestion.value
  });

  placesAutocomplete.on('clear', function() {
    $address.textContent = 'none';
  });

  var $country = document.querySelector('#country-selector')
  $country.addEventListener('change', function(e){
    placesAutocomplete.configure({ countries: [e.target.value] });
  })

})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class=rouge-code><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"dynamic-control-group"</span> <span class="na">style=</span><span class="s">"max-width: 240px"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"country-selector"</span><span class="nt">&gt;</span>Select country<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"country-selector"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"fr"</span><span class="nt">&gt;</span>France<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"us"</span><span class="nt">&gt;</span>United States<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"single-country-search"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;p&gt;</span>Selected: <span class="nt">&lt;strong</span> <span class="na">id=</span><span class="s">"single-country-address-value"</span><span class="nt">&gt;</span>none<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#single-country-search'</span><span class="p">)</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">countries</span><span class="p">:</span> <span class="p">[</span><span class="s1">'fr'</span><span class="p">]</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$address</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#single-country-address-value'</span><span class="p">)</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$address</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">value</span>
  <span class="p">});</span>

  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'clear'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$address</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'none'</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$country</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#country-selector'</span><span class="p">)</span>
  <span class="nx">$country</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">countries</span><span class="p">:</span> <span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">]</span> <span class="p">});</span>
  <span class="p">})</span>

<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p><strong>Note:</strong> It is considered a best practice to restrict Places search to only the countries that are relevant to your use case. Restricting Places to a single country can greatly improve the relevance of the results.</p> <h3 id=search-around-latlng>Search around lat/lng</h3> <p><strong>Concepts:</strong> <a href="documentation.html#api-options-aroundLatLng">aroundLatLng</a> and <a href="documentation.html##api-options-aroundRadius">aroundRadius</a> parameters.</p> <p>Reusing the <a href="#displaying-on-a-map">map</a> example, we want to only search around Paris, France.</p> <p>This is useful when you really want to display results around a specific area.</p> <div id=map-example-container-paris></div> <p><input type=search id=input-map-paris class=form-control placeholder="Find a street in Paris, France. Try &quot;Rivoli&quot;"/></p> <style>
  #map-example-container-paris {
    height: 300px
  }
</style> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var latlng = {
    lat: 48.8566,
    lng: 2.34287
  };

  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#input-map-paris')
  }).configure({
    aroundLatLng: latlng.lat + ',' + latlng.lng, // Paris latitude longitude
    aroundRadius: 10 * 1000, // 10km radius
    type: 'address'
  });

  var map = L.map('map-example-container-paris', {
    scrollWheelZoom: false,
    zoomControl: false
  });

  var osmLayer = new L.TileLayer(
    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      minZoom: 12,
      maxZoom: 18,
      attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'
    }
  );

  var markers = [];

  map.setView(new L.LatLng(latlng.lat, latlng.lng), 12);
  map.addLayer(osmLayer);

  placesAutocomplete.on('suggestions', handleOnSuggestions);
  placesAutocomplete.on('cursorchanged', handleOnCursorchanged);
  placesAutocomplete.on('change', handleOnChange);

  function handleOnSuggestions(e) {
    markers.forEach(removeMarker);
    markers = [];

    if (e.suggestions.length === 0) {
      map.setView(new L.LatLng(latlng.lat, latlng.lng), 12);
      return;
    }

    e.suggestions.forEach(addMarker);
    findBestZoom();
  }

  function handleOnChange(e) {
    markers
      .forEach(function(marker, markerIndex) {
        if (markerIndex === e.suggestionIndex) {
          markers = [marker];
          marker.setOpacity(1);
          findBestZoom();
        } else {
          removeMarker(marker);
        }
      });
  }

  function handleOnClear() {
    map.setView(new L.LatLng(latlng.lat, latlng.lng), 12);
  }

  function handleOnCursorchanged(e) {
    markers
      .forEach(function(marker, markerIndex) {
        if (markerIndex === e.suggestionIndex) {
          marker.setOpacity(1);
          marker.setZIndexOffset(1000);
        } else {
          marker.setZIndexOffset(0);
          marker.setOpacity(0.5);
        }
      });
  }

  function addMarker(suggestion) {
    var marker = L.marker(suggestion.latlng, {opacity: .4});
    marker.addTo(map);
    markers.push(marker);
  }

  function removeMarker(marker) {
    map.removeLayer(marker);
  }

  function findBestZoom() {
    var featureGroup = L.featureGroup(markers);
    map.fitBounds(featureGroup.getBounds().pad(0.5), {animate: false});
  }
})();
</script> <p>To try this example, you need to add leaflet in your code:</p> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class=rouge-code><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://cdn.jsdelivr.net/leaflet/1/leaflet.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/leaflet/1/leaflet.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p>Then use this:</p> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
</pre></td><td class=rouge-code><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map-example-container-paris"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"input-map-paris"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Find a street in Paris, France. Try &amp;quot;Rivoli&amp;quot;"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;style&gt;</span>
  <span class="nf">#map-example-container-paris</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">300px</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">latlng</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">lat</span><span class="p">:</span> <span class="mf">48.8566</span><span class="p">,</span>
    <span class="na">lng</span><span class="p">:</span> <span class="mf">2.34287</span>
  <span class="p">};</span>

  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#input-map-paris'</span><span class="p">)</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">aroundLatLng</span><span class="p">:</span> <span class="nx">latlng</span><span class="p">.</span><span class="nx">lat</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">latlng</span><span class="p">.</span><span class="nx">lng</span><span class="p">,</span> <span class="c1">// Paris latitude longitude</span>
    <span class="na">aroundRadius</span><span class="p">:</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="c1">// 10km radius</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'address'</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">map</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">'map-example-container-paris'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">scrollWheelZoom</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">zoomControl</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">osmLayer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">TileLayer</span><span class="p">(</span>
    <span class="s1">'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">minZoom</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
      <span class="na">maxZoom</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
      <span class="na">attribution</span><span class="p">:</span> <span class="s1">'Map data © &lt;a href="https://openstreetmap.org"&gt;OpenStreetMap&lt;/a&gt; contributors'</span>
    <span class="p">}</span>
  <span class="p">);</span>

  <span class="kd">var</span> <span class="nx">markers</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">(</span><span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="nx">latlng</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">latlng</span><span class="p">.</span><span class="nx">lng</span><span class="p">),</span> <span class="mi">12</span><span class="p">);</span>
  <span class="nx">map</span><span class="p">.</span><span class="nx">addLayer</span><span class="p">(</span><span class="nx">osmLayer</span><span class="p">);</span>

  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'suggestions'</span><span class="p">,</span> <span class="nx">handleOnSuggestions</span><span class="p">);</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'cursorchanged'</span><span class="p">,</span> <span class="nx">handleOnCursorchanged</span><span class="p">);</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">handleOnChange</span><span class="p">);</span>

  <span class="kd">function</span> <span class="nx">handleOnSuggestions</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markers</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">removeMarker</span><span class="p">);</span>
    <span class="nx">markers</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">suggestions</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">(</span><span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="nx">latlng</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">latlng</span><span class="p">.</span><span class="nx">lng</span><span class="p">),</span> <span class="mi">12</span><span class="p">);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">e</span><span class="p">.</span><span class="nx">suggestions</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">addMarker</span><span class="p">);</span>
    <span class="nx">findBestZoom</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">handleOnChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markers</span>
      <span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">marker</span><span class="p">,</span> <span class="nx">markerIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">markerIndex</span> <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestionIndex</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">markers</span> <span class="o">=</span> <span class="p">[</span><span class="nx">marker</span><span class="p">];</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
          <span class="nx">findBestZoom</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">removeMarker</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">handleOnClear</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">setView</span><span class="p">(</span><span class="k">new</span> <span class="nx">L</span><span class="p">.</span><span class="nx">LatLng</span><span class="p">(</span><span class="nx">latlng</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span> <span class="nx">latlng</span><span class="p">.</span><span class="nx">lng</span><span class="p">),</span> <span class="mi">12</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">handleOnCursorchanged</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">markers</span>
      <span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">marker</span><span class="p">,</span> <span class="nx">markerIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">markerIndex</span> <span class="o">===</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestionIndex</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setZIndexOffset</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setZIndexOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
          <span class="nx">marker</span><span class="p">.</span><span class="nx">setOpacity</span><span class="p">(</span><span class="mf">0.5</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">addMarker</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">latlng</span><span class="p">,</span> <span class="p">{</span><span class="na">opacity</span><span class="p">:</span> <span class="p">.</span><span class="mi">4</span><span class="p">});</span>
    <span class="nx">marker</span><span class="p">.</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">map</span><span class="p">);</span>
    <span class="nx">markers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">removeMarker</span><span class="p">(</span><span class="nx">marker</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">removeLayer</span><span class="p">(</span><span class="nx">marker</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">findBestZoom</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">featureGroup</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">featureGroup</span><span class="p">(</span><span class="nx">markers</span><span class="p">);</span>
    <span class="nx">map</span><span class="p">.</span><span class="nx">fitBounds</span><span class="p">(</span><span class="nx">featureGroup</span><span class="p">.</span><span class="nx">getBounds</span><span class="p">().</span><span class="nx">pad</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="p">{</span><span class="na">animate</span><span class="p">:</span> <span class="kc">false</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p><strong>Note:</strong> Both parameters are key to restrict the search to a certain area. If a location is passed in <code>aroundLatLng</code> without the <code>aroundRadius</code> parameter being set, Places will prioritize results around the location but will also search the rest of the world for additional results. This is why the <code>aroundLatLng</code> parameter should be considered as a wait to <em>first</em> search around a location rather than as a filter.</p> <h2 id=advanced>Advanced</h2> <h3 id=dynamic-control>Dynamic control</h3> <p>Using the <code>.configure</code> method, you can dynamically modify the behaviour of the Places search, to better tailor it to your users' need.</p> <p>For instance, if your service covers multiple countries or is available in multiple languages, you can dynamically modify Places configuration to better represent where your customer wants to search and in which language the results should be displayed.</p> <style>
  .dynamic-controls {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
  }

  .dynamic-control-group {
    padding: 8px;
    box-sizing: border-box; 
    display: flex;
    flex-direction: column;
    flex: 1 1 auto;
    align-items: stretch;
    width: 100%;
  }

  .dynamic-control-group > label {
    font-size: 12px;
    margin-bottom: 4px;
    color: #333;
    text-transform: uppercase;
  }
  .dynamic-control-group > select {
    height: 32px;
    overflow: hidden;
  }
</style> <div class=dynamic-controls> <div class=dynamic-control-group> <label for=dynamic-country-selector>Search in country</label> <select id=dynamic-country-selector class="btn btn-black"> <option value=de>Germany</option> <option value=us>United States</option> <option value="">World</option> </select> </div> <div class=dynamic-control-group> <label for=dynamic-type-selector>Search for</label> <select id=dynamic-type-selector class="btn btn-black"> <option value=city>City</option> <option value=address>Address</option> </select> </div> <div class=dynamic-control-group> <label for=dynamic-language-selector>Display in</label> <select id=dynamic-language-selector class="btn btn-black"> <option value=en>English</option> <option value=de>German</option> <option value="">Use default</option> </select> </div> <div class=dynamic-control-group> <label for=dynamic-nb-hits>Display X results</label> <select id=dynamic-nb-hits class="btn btn-black"> <option value=4>4</option> <option value=8>8</option> <option value=0>Use default (5)</option> </select> </div> </div> <p><input type=search id=dynamic-search class=form-control placeholder="Where are we going?"/></p> <p>Selected: <strong id=dynamic-address-value>none</strong></p> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
(function() {
  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#dynamic-search')
  }).configure({
    countries: ['de'],
    type: 'city',
    language: 'en',
    hitsPerPage: 4
  });

  var $address = document.querySelector('#dynamic-address-value')
  placesAutocomplete.on('change', function(e) {
    $address.textContent = e.suggestion.value
  });

  placesAutocomplete.on('clear', function() {
    $address.textContent = 'none';
  });

  var $country = document.querySelector('#dynamic-country-selector')
  $country.addEventListener('change', function(e){
    var country = e.target.value;
    if (country) {
      placesAutocomplete.configure({ countries: [country] });
    }
    else {
      placesAutocomplete.configure({ countries: undefined });
    }
  });

  var $type = document.querySelector('#dynamic-type-selector')
  $type.addEventListener('change', function(e){
    placesAutocomplete.configure({ type: e.target.value });
  });

  var $language = document.querySelector('#dynamic-language-selector')
  $language.addEventListener('change', function(e){
    var language = e.target.value;
    if (language) {
      placesAutocomplete.configure({ language: language });
    }
    else {
      placesAutocomplete.configure({ language: undefined });
    }
  });

  var $nbHits = document.querySelector('#dynamic-nb-hits')
  $nbHits.addEventListener('change', function(e) {
    var hitsPerPage = parseInt(e.target.value, 10);

    if (hitsPerPage) {
      placesAutocomplete.configure({ hitsPerPage: hitsPerPage });
    }
    else {
      placesAutocomplete.configure({ hitsPerPage: undefined });
    }
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
</pre></td><td class=rouge-code><pre><span class="nt">&lt;style&gt;</span>
  <span class="nc">.dynamic-controls</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">row</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="nl">justify-content</span><span class="p">:</span> <span class="n">space-between</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.dynamic-control-group</span> <span class="p">{</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
    <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span> 
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">column</span><span class="p">;</span>
    <span class="nl">flex</span><span class="p">:</span> <span class="m">1</span> <span class="m">1</span> <span class="nb">auto</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="n">stretch</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.dynamic-control-group</span> <span class="o">&gt;</span> <span class="nt">label</span> <span class="p">{</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">12px</span><span class="p">;</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="m">#333</span><span class="p">;</span>
    <span class="nl">text-transform</span><span class="p">:</span> <span class="nb">uppercase</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nc">.dynamic-control-group</span> <span class="o">&gt;</span> <span class="nt">select</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">32px</span><span class="p">;</span>
    <span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"dynamic-controls"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"dynamic-control-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-country-selector"</span><span class="nt">&gt;</span>Search in country<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"dynamic-country-selector"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"de"</span><span class="nt">&gt;</span>Germany<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"us"</span><span class="nt">&gt;</span>United States<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>World<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"dynamic-control-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-type-selector"</span><span class="nt">&gt;</span>Search for<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"dynamic-type-selector"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"city"</span><span class="nt">&gt;</span>City<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"address"</span><span class="nt">&gt;</span>Address<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"dynamic-control-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-language-selector"</span><span class="nt">&gt;</span>Display in<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"dynamic-language-selector"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"en"</span><span class="nt">&gt;</span>English<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"de"</span><span class="nt">&gt;</span>German<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>Use default<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"dynamic-control-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-nb-hits"</span><span class="nt">&gt;</span>Display X results<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"dynamic-nb-hits"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"4"</span><span class="nt">&gt;</span>4<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"8"</span><span class="nt">&gt;</span>8<span class="nt">&lt;/option&gt;</span>
      <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"0"</span><span class="nt">&gt;</span>Use default (5)<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"dynamic-search"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;p&gt;</span>Selected: <span class="nt">&lt;strong</span> <span class="na">id=</span><span class="s">"dynamic-address-value"</span><span class="nt">&gt;</span>none<span class="nt">&lt;/strong&gt;&lt;/p&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-search'</span><span class="p">)</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">countries</span><span class="p">:</span> <span class="p">[</span><span class="s1">'de'</span><span class="p">],</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'city'</span><span class="p">,</span>
    <span class="na">language</span><span class="p">:</span> <span class="s1">'en'</span><span class="p">,</span>
    <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">4</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$address</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-address-value'</span><span class="p">)</span>
  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$address</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">value</span>
  <span class="p">});</span>

  <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'clear'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$address</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'none'</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$country</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-country-selector'</span><span class="p">)</span>
  <span class="nx">$country</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">country</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">countries</span><span class="p">:</span> <span class="p">[</span><span class="nx">country</span><span class="p">]</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">countries</span><span class="p">:</span> <span class="kc">undefined</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$type</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-type-selector'</span><span class="p">)</span>
  <span class="nx">$type</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span> <span class="p">});</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$language</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-language-selector'</span><span class="p">)</span>
  <span class="nx">$language</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">language</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">language</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">language</span><span class="p">:</span> <span class="nx">language</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">language</span><span class="p">:</span> <span class="kc">undefined</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="kd">var</span> <span class="nx">$nbHits</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-nb-hits'</span><span class="p">)</span>
  <span class="nx">$nbHits</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hitsPerPage</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">hitsPerPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">hitsPerPage</span><span class="p">:</span> <span class="nx">hitsPerPage</span> <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
      <span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">hitsPerPage</span><span class="p">:</span> <span class="kc">undefined</span> <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <h3 id=places--custom-data>Places + Custom data</h3> <p>Using <a href="https://github.com/algolia/autocomplete.js">Algolia's autocomplete.js</a> library, you can search in your own data along with showing Algolia Places results.</p> <p>You need an Algolia account to do so and the Algolia Places dataset:</p> <p><input type=search id=autocomplete-dataset class=form-control placeholder="Search for vacation rentals or cities"/></p> <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearchLite.min.js"></script> <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.js"></script> <style>
.algolia-autocomplete {
  width: 100%;
}
.ad-example-dropdown-menu {
  width: 100%;
  color: black;
  background-color: #fff;
  border: 1px solid #ccc;
  border-top: none;
  border-radius: 5px;
  padding: .5em;
  box-shadow: 1px 1px 32px -10px rgba(0,0,0,0.62);
}
.ad-example-dropdown-menu .ad-example-suggestion {
  cursor: pointer;
  padding: 5px 4px;
}
.ad-example-dropdown-menu .ad-example-suggestion img {
  height: 2em;
  margin-top: .5em;
  margin-right: 10px;
  float: left;
}
.ad-example-dropdown-menu .ad-example-suggestion small {
  font-size: .8em;
  color: #bbb;
}
.ad-example-dropdown-menu .ad-example-suggestion.ad-example-cursor {
  background-color: #B2D7FF;
}
.ad-example-dropdown-menu .ad-example-suggestion em {
  font-weight: bold;
  font-style: normal;
}
.ad-example-header {
  font-weight: bold;
  padding: .5em 0;
  margin-bottom: 1em;
  border-bottom: 1px solid #ccc;
}
</style> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1/dist/cdn/placesAutocompleteDataset.min.js"></script> <script>
(function() {
  var client = algoliasearch('latency', '6be0576ff61c053d5f9a3225e2a90f76');
  var index = client.initIndex('airbnb');

  // create the first autocomplete.js dataset: vacation rentals
  var rentalsDataset = {
    source: autocomplete.sources.hits(index, {hitsPerPage: 2}),
    displayKey: 'name',
    name: 'rentals',
    templates: {
      header: '<div class="ad-example-header">Vacation rentals</div>',
      suggestion: function(suggestion) {
        return '<img src="' + suggestion.thumbnail_url + '" />' +
          '<div>' +
            suggestion._highlightResult.name.value + '<br />' +
            '<small>' + suggestion._highlightResult.city.value + '</small>' +
         '</div>';
      }
    }
  };

  // create the second dataset: places
  // we automatically inject the default CSS
  // all the places.js options are available
  var placesDataset = placesAutocompleteDataset({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    algoliasearch: algoliasearch,
    templates: {
      header: '<div class="ad-example-header">Cities</div>'
    },
    hitsPerPage: 3
  });

  // init
  var autocompleteInstance = autocomplete(document.querySelector('#autocomplete-dataset'), {
    hint: false,
    debug: true,
    cssClasses: {prefix: 'ad-example'}
  }, [
    rentalsDataset,
    placesDataset
  ]);

  var autocompleteChangeEvents = ['selected', 'autocompleted'];

  autocompleteChangeEvents.forEach(function(eventName) {
    autocompleteInstance.on('autocomplete:'+ eventName, function(event, suggestion, datasetName) {
      console.log(datasetName, suggestion);
    });
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
</pre></td><td class=rouge-code><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"autocomplete-dataset"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Search for vacation rentals or cities"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/algoliasearch/3/algoliasearchLite.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
<span class="nc">.algolia-autocomplete</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ad-example-dropdown-menu</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">color</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ccc</span><span class="p">;</span>
  <span class="nl">border-top</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">.5em</span><span class="p">;</span>
  <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">1px</span> <span class="m">1px</span> <span class="m">32px</span> <span class="m">-10px</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.62</span><span class="p">);</span>
<span class="p">}</span>
<span class="nc">.ad-example-dropdown-menu</span> <span class="nc">.ad-example-suggestion</span> <span class="p">{</span>
  <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span> <span class="m">4px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ad-example-dropdown-menu</span> <span class="nc">.ad-example-suggestion</span> <span class="nt">img</span> <span class="p">{</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">2em</span><span class="p">;</span>
  <span class="nl">margin-top</span><span class="p">:</span> <span class="m">.5em</span><span class="p">;</span>
  <span class="nl">margin-right</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ad-example-dropdown-menu</span> <span class="nc">.ad-example-suggestion</span> <span class="nt">small</span> <span class="p">{</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">.8em</span><span class="p">;</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#bbb</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ad-example-dropdown-menu</span> <span class="nc">.ad-example-suggestion.ad-example-cursor</span> <span class="p">{</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#B2D7FF</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ad-example-dropdown-menu</span> <span class="nc">.ad-example-suggestion</span> <span class="nt">em</span> <span class="p">{</span>
  <span class="nl">font-weight</span><span class="p">:</span> <span class="nb">bold</span><span class="p">;</span>
  <span class="nl">font-style</span><span class="p">:</span> <span class="nb">normal</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.ad-example-header</span> <span class="p">{</span>
  <span class="nl">font-weight</span><span class="p">:</span> <span class="nb">bold</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">.5em</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">1em</span><span class="p">;</span>
  <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ccc</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1/dist/cdn/placesAutocompleteDataset.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">algoliasearch</span><span class="p">(</span><span class="s1">'latency'</span><span class="p">,</span> <span class="s1">'6be0576ff61c053d5f9a3225e2a90f76'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">initIndex</span><span class="p">(</span><span class="s1">'airbnb'</span><span class="p">);</span>

  <span class="c1">// create the first autocomplete.js dataset: vacation rentals</span>
  <span class="kd">var</span> <span class="nx">rentalsDataset</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">source</span><span class="p">:</span> <span class="nx">autocomplete</span><span class="p">.</span><span class="nx">sources</span><span class="p">.</span><span class="nx">hits</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="p">{</span><span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">2</span><span class="p">}),</span>
    <span class="na">displayKey</span><span class="p">:</span> <span class="s1">'name'</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'rentals'</span><span class="p">,</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">header</span><span class="p">:</span> <span class="s1">'&lt;div class="ad-example-header"&gt;Vacation rentals&lt;/div&gt;'</span><span class="p">,</span>
      <span class="na">suggestion</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'&lt;img src="'</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">thumbnail_url</span> <span class="o">+</span> <span class="s1">'" /&gt;'</span> <span class="o">+</span>
          <span class="s1">'&lt;div&gt;'</span> <span class="o">+</span>
            <span class="nx">suggestion</span><span class="p">.</span><span class="nx">_highlightResult</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">'&lt;br /&gt;'</span> <span class="o">+</span>
            <span class="s1">'&lt;small&gt;'</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">_highlightResult</span><span class="p">.</span><span class="nx">city</span><span class="p">.</span><span class="nx">value</span> <span class="o">+</span> <span class="s1">'&lt;/small&gt;'</span> <span class="o">+</span>
         <span class="s1">'&lt;/div&gt;'</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="c1">// create the second dataset: places</span>
  <span class="c1">// we automatically inject the default CSS</span>
  <span class="c1">// all the places.js options are available</span>
  <span class="kd">var</span> <span class="nx">placesDataset</span> <span class="o">=</span> <span class="nx">placesAutocompleteDataset</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">algoliasearch</span><span class="p">:</span> <span class="nx">algoliasearch</span><span class="p">,</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">header</span><span class="p">:</span> <span class="s1">'&lt;div class="ad-example-header"&gt;Cities&lt;/div&gt;'</span>
    <span class="p">},</span>
    <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">});</span>

  <span class="c1">// init</span>
  <span class="kd">var</span> <span class="nx">autocompleteInstance</span> <span class="o">=</span> <span class="nx">autocomplete</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#autocomplete-dataset'</span><span class="p">),</span> <span class="p">{</span>
    <span class="na">hint</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">debug</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">cssClasses</span><span class="p">:</span> <span class="p">{</span><span class="na">prefix</span><span class="p">:</span> <span class="s1">'ad-example'</span><span class="p">}</span>
  <span class="p">},</span> <span class="p">[</span>
    <span class="nx">rentalsDataset</span><span class="p">,</span>
    <span class="nx">placesDataset</span>
  <span class="p">]);</span>

  <span class="kd">var</span> <span class="nx">autocompleteChangeEvents</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'selected'</span><span class="p">,</span> <span class="s1">'autocompleted'</span><span class="p">];</span>

  <span class="nx">autocompleteChangeEvents</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">eventName</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">autocompleteInstance</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'autocomplete:'</span><span class="o">+</span> <span class="nx">eventName</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">suggestion</span><span class="p">,</span> <span class="nx">datasetName</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">datasetName</span><span class="p">,</span> <span class="nx">suggestion</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p>See the documentation about the <a href="documentation.html#autocompletejs">placesAutocompleteDataset function</a>.</p> <h3 id=places--instantsearch>Places + InstantSearch</h3> <p><input type=search id=input-map-instantsearch class=form-control placeholder="Where are you looking for a coffee?"/></p> <div id=map-instantsearch-container></div> <style>
  #map-instantsearch-container {height: 300px};
</style> <script src="https://cdn.jsdelivr.net/instantsearch.js/2.10.1/instantsearch.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1/dist/cdn/placesInstantsearchWidget.min.js"></script> <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBawL8VbstJDdU5397SUX7pEt9DslAwWgQ"></script> <script>
(function() {
var search = instantsearch({
  appId: 'latency',
  apiKey: 'ffc36feb6e9df06e1c3c4549b5af2b31',
  indexName: 'starbucks',
});

var configure = instantsearch.widgets.configure({
  hitsPerPage: 25,
});

var searchBox = placesInstantsearchWidget({
  appId: 'plFMJJT5O9PC',
  apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
  container: document.querySelector('#input-map-instantsearch')
});

var geosearch = instantsearch.widgets.geoSearch({
  container: '#map-instantsearch-container',
  googleReference: window.google,
  builtInMarker: {
    createOptions: function(item) {
      return {
        title: item.Brand + ' ' + item.Name
      };
    }
  }
});

search.addWidget(configure);
search.addWidget(searchBox);
search.addWidget(geosearch);
search.start();
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class=rouge-code><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"input-map-instantsearch"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are you looking for a coffee?"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map-instantsearch-container"</span><span class="nt">&gt;&lt;/div&gt;</span>

<span class="nt">&lt;style&gt;</span>
  <span class="nf">#map-instantsearch-container</span> <span class="p">{</span><span class="nl">height</span><span class="p">:</span> <span class="m">300px</span><span class="p">}</span><span class="o">;</span>
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/instantsearch.js/2.10.1/instantsearch.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1/dist/cdn/placesInstantsearchWidget.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maps.googleapis.com/maps/api/js?key=AIzaSyBawL8VbstJDdU5397SUX7pEt9DslAwWgQ"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">search</span> <span class="o">=</span> <span class="nx">instantsearch</span><span class="p">({</span>
  <span class="na">appId</span><span class="p">:</span> <span class="s1">'latency'</span><span class="p">,</span>
  <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'ffc36feb6e9df06e1c3c4549b5af2b31'</span><span class="p">,</span>
  <span class="na">indexName</span><span class="p">:</span> <span class="s1">'starbucks'</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">configure</span> <span class="o">=</span> <span class="nx">instantsearch</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span>
  <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">searchBox</span> <span class="o">=</span> <span class="nx">placesInstantsearchWidget</span><span class="p">({</span>
  <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
  <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
  <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#input-map-instantsearch'</span><span class="p">)</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">geosearch</span> <span class="o">=</span> <span class="nx">instantsearch</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">geoSearch</span><span class="p">({</span>
  <span class="na">container</span><span class="p">:</span> <span class="s1">'#map-instantsearch-container'</span><span class="p">,</span>
  <span class="na">googleReference</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">google</span><span class="p">,</span>
  <span class="na">builtInMarker</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">createOptions</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">title</span><span class="p">:</span> <span class="nx">item</span><span class="p">.</span><span class="nx">Brand</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="nx">item</span><span class="p">.</span><span class="nx">Name</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">search</span><span class="p">.</span><span class="nx">addWidget</span><span class="p">(</span><span class="nx">configure</span><span class="p">);</span>
<span class="nx">search</span><span class="p">.</span><span class="nx">addWidget</span><span class="p">(</span><span class="nx">searchBox</span><span class="p">);</span>
<span class="nx">search</span><span class="p">.</span><span class="nx">addWidget</span><span class="p">(</span><span class="nx">geosearch</span><span class="p">);</span>
<span class="nx">search</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <h3 id=nearby-city-search>Nearby City Search</h3> <p><strong>Concepts:</strong> type parameter, aroundLatLngViaIP, aroundPrecision, programmatic search.</p> <p>In this section, we will see how you can <em>emulate</em> reverse geocoding to find city closest to a user using the Places API Client.</p> <div> <p>When constructing a search UI using InstantSearch, you may want to filter your dataset to only display some of your products based on the distance to the end user. This is usually done using the aroundLatLngViaIP filter, or aroundLatLng filter if you have access to precise geolocation information. However geographical filters are hard to interpret when displayed in raw format, as noone really knows where the coordinates <span id=coords><code>48.8566, 2.34287</code></span> are.</p> <p>Using Places, you can do a query to find the city in which your user is located and display that city name instead of a geolocation.</p> </div> <p><strong>Example:</strong></p> <div> <strong>Searching around: </strong> <input type=search id=reverse-city placeholder="Your favorite city"/> </div> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script>
var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#reverse-city')
  }).configure({
    type: 'city',
    hitsPerPage: 5,
    aroundLatLngViaIP: true,
    debug: true
  });

placesAutocomplete.search().then(function(suggestions) {
  if (!suggestions[0]) {
    return;
  }

  var name = suggestions[0].name;
  var country = suggestions[0].country;
  var latlng = suggestions[0].latlng;
  var formattedCity = name + ', ' + country;

  var coordElt = document.querySelector("#coords");
  var lat = latlng.lat;
  var lng = latlng.lng;
  coordElt.innerHTML = '<code>' + lat + ', ' + lng + '</code>';

  var infoElt = document.querySelector("#reverse-city");
  infoElt.value = formattedCity;
});

placesAutocomplete.on('change', (response) => {
  var suggestion = response.suggestion;
  var latlng = suggestion.latlng;
  var coordElt = document.querySelector("#coords");
  var lat = latlng.lat;
  var lng = latlng.lng;
  coordElt.innerHTML = '<code>' + lat + ', ' + lng + '</code>';
});
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class=rouge-code><pre><span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;strong&gt;</span>Searching around: <span class="nt">&lt;/strong&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"reverse-city"</span> <span class="na">placeholder=</span><span class="s">"What's your favorite city?"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-city'</span><span class="p">)</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'city'</span><span class="p">,</span>
    <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">aroundLatLngViaIP</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">});</span>

<span class="nx">placesAutocomplete</span><span class="p">.</span><span class="nx">search</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">suggestions</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">suggestions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">suggestions</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">name</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">suggestions</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">country</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">formattedCity</span> <span class="o">=</span> <span class="nx">locale_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">', '</span> <span class="o">+</span> <span class="nx">country</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">infoElt</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"#reverse-city"</span><span class="p">);</span>
  <span class="nx">infoElt</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">formattedCity</span><span class="p">;</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p><strong>Note:</strong> This is not a reverse geocoding API, and it is still bound by the ranking used for search, which means that in some cases large close-by cities can be promoted over a more closely located city.</p> <h3 id=using-an-api-client>Using an API client</h3> <p>In some cases, you may not want to tie your Places search to an input, but rather access it only programmatically.</p> <p>In these cases, you can use the regular JavaScript API Client, or the api client in your preferred language. You can head to the <a href="api-clients.html">API Clients page</a> to see which api clients support Places.</p> <p>For instance, here we will rewrite the previous example using the JS api client instead.</p> <div> <strong>Searching around: </strong> <div id=api-client-reverse-city></div> </div> <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script> <script>
var placesClient = algoliasearch.initPlaces(
  'plFMJJT5O9PC',
  '8b126ce956636c64b6e74c8b3f3d0e5e'
);

var preferredLanguage = window.navigator.language.split('-')[0];

placesClient.search({
  query: '',
  aroundLatLngViaIP: true,
  type: 'city',
  hitsPerPage: 1,
  language: preferredLanguage,
}).then(function(results) {
  var hits = results.hits;
  if (!hits[0]) {
    return;
  }
  var locale_names = hits[0].locale_names;
  var country = hits[0].country;
  var formattedCity = locale_names[0] + ', ' + country;

  var infoElt = document.querySelector("#api-client-reverse-city");
  infoElt.textContent = formattedCity;
});
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class=rouge-code><pre><span class="nt">&lt;div&gt;</span>
  <span class="nt">&lt;strong&gt;</span>Searching around: <span class="nt">&lt;/strong&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"api-client-reverse-city"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">placesClient</span> <span class="o">=</span> <span class="nx">algoliasearch</span><span class="p">.</span><span class="nx">initPlaces</span><span class="p">(</span>
  <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
  <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span>
<span class="p">);</span>

<span class="kd">var</span> <span class="nx">preferredLanguage</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'-'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

<span class="nx">placesClient</span><span class="p">.</span><span class="nx">search</span><span class="p">({</span>
  <span class="na">query</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="na">aroundLatLngViaIP</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">type</span><span class="p">:</span> <span class="s1">'city'</span><span class="p">,</span>
  <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="na">language</span><span class="p">:</span> <span class="nx">preferredLanguage</span><span class="p">,</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">hits</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">hits</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">locale_names</span> <span class="o">=</span> <span class="nx">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">locale_names</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">country</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">formattedCity</span> <span class="o">=</span> <span class="nx">locale_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">', '</span> <span class="o">+</span> <span class="nx">country</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">infoElt</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">"#api-client-reverse-city"</span><span class="p">);</span>
  <span class="nx">infoElt</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">formattedCity</span><span class="p">;</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p><strong>Note:</strong> This example uses the standard <a href="https://github.com/algolia/algoliasearch-client-javascript">JavaScript API client</a> in which the Places API is integrated. This example does not use the Places.js library.</p> <p><strong>Note:</strong> This is not a reverse geocoding API, and it is still bound by the ranking used for search, which means that in some cases large close-by cities can be promoted over a more closely located city. You should use the reverse API if you want results that are only affected by the geolocation.</p> <h3 id=reverse-geocoding>Reverse geocoding</h3> <p><strong>Concepts:</strong> reverse API.</p> <p>In this section, we will see how you can do reverse geocoding with a precision up to the street using the reverse places client.</p> <style>
  .reverse-geo-controls {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-end;
  }
</style> <div style="display: none;"> <input id=reverse-demo-ignored /> </div> <div class=reverse-geo-controls> <div class=form-group style="flex-grow: 1; margin-right: 8px;"> <label for=reverse-geo-lat>Latitude</label> <input id=reverse-geo-lat class=form-control placeholder="try 48.87"/> </div> <div class=form-group style="flex-grow: 1; margin-left: 8px; margin-right: 8px;"> <label for=reverse-geo-lng>Longitude</label> <input id=reverse-geo-lng class=form-control placeholder="try 2.31"/> </div> <div class=form-group style="margin-left: 8px;"> <button id=reverse-locate-me class="btn btn-black" style="width: 150px;">Locate me</button> </div> </div> <form action="/locate" class=form> <div class=form-group> <label for=reverse-address>Address</label> <input class=form-control id=reverse-address placeholder="Street number and name"/> </div> <div class=form-group> <label for=reverse-town>City*</label> <input class=form-control id=reverse-town placeholder=City /> </div> <div class=form-group> <label for=reverse-zip>ZIP code*</label> <input class=form-control id=reverse-zip placeholder="ZIP code"/> </div> </form> <script src="https://cdn.jsdelivr.net/algoliasearch/3.31/algoliasearchLite.min.js"></script> <script>
(function() {
  var places = algoliasearch.initPlaces('plFMJJT5O9PC', '8b126ce956636c64b6e74c8b3f3d0e5e');
  
  function updateForm(response) {
    var hits = response.hits;
    var suggestion = hits[0];

    if (suggestion && suggestion.locale_names && suggestion.city) {
      document.querySelector('#reverse-address').value = suggestion.locale_names.default[0] || '';
      document.querySelector('#reverse-town').value = suggestion.city.default[0] || '';
      document.querySelector('#reverse-zip').value = (suggestion.postcode || [])[0] || '';
    }
  }

  var lat, lng;

  var $button = document.querySelector('#reverse-locate-me');
  var $latInput = document.querySelector('#reverse-geo-lat');
  var $lngInput = document.querySelector('#reverse-geo-lng');

  $latInput.addEventListener('change', function(e) {
    try {
      lat = parseFloat(e.target.value);

      if (typeof lat !== 'undefined' && typeof lng !== 'undefined') {
        places.reverse({
          aroundLatLng: lat + ',' + lng,
          hitsPerPage: 1,
        }).then(updateForm);
      }
    } catch (e) {
      lat = undefined;
    }
  });

  $lngInput.addEventListener('change', function(e) {
    try {
      lng = parseFloat(e.target.value);

      if (typeof lat !== 'undefined' && typeof lng !== 'undefined') {
        places.reverse({
          aroundLatLng: lat + ',' + lng,
          hitsPerPage: 1,
        }).then(updateForm);
      }
    } catch (e) {
      lng = undefined;
    }
  });

  $button.addEventListener('click', function() {
    $button.textContent = 'Locating...';

    navigator.geolocation.getCurrentPosition(function(response) {
      var coords = response.coords;
      lat = coords.latitude.toFixed(6);
      lng = coords.longitude.toFixed(6);
      
      $latInput.value = lat;
      $lngInput.value = lng;

      $button.textContent = 'Locate me';
      
      places.reverse({
        aroundLatLng: lat + ',' + lng,
        hitsPerPage: 1
      }).then(updateForm);
    });
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
</pre></td><td class=rouge-code><pre><span class="nt">&lt;style&gt;</span>
  <span class="nc">.reverse-geo-controls</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">row</span><span class="p">;</span>
    <span class="nl">justify-content</span><span class="p">:</span> <span class="n">space-between</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="n">flex-end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"display: none;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"reverse-demo-ignored"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"reverse-geo-controls"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span> <span class="na">style=</span><span class="s">"flex-grow: 1; margin-right: 8px;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"reverse-geo-lat"</span><span class="nt">&gt;</span>Latitude<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"reverse-geo-lat"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"try 48.87"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span> <span class="na">style=</span><span class="s">"flex-grow: 1; margin-left: 8px; margin-right: 8px;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"reverse-geo-lng"</span><span class="nt">&gt;</span>Longitude<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"reverse-geo-lng"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"try 2.31"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span> <span class="na">style=</span><span class="s">"margin-left: 8px;"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"reverse-locate-me"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span> <span class="na">style=</span><span class="s">"width: 150px;"</span><span class="nt">&gt;</span>Locate me<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/locate"</span> <span class="na">class=</span><span class="s">"form"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"reverse-address"</span><span class="nt">&gt;</span>Address<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"reverse-address"</span> <span class="na">placeholder=</span><span class="s">"Street number and name"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"reverse-town"</span><span class="nt">&gt;</span>City*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"reverse-town"</span> <span class="na">placeholder=</span><span class="s">"City"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"reverse-zip"</span><span class="nt">&gt;</span>ZIP code*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"reverse-zip"</span> <span class="na">placeholder=</span><span class="s">"ZIP code"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/algoliasearch/3.31/algoliasearchLite.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">places</span> <span class="o">=</span> <span class="nx">algoliasearch</span><span class="p">.</span><span class="nx">initPlaces</span><span class="p">(</span><span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">);</span>
  
  <span class="kd">function</span> <span class="nx">updateForm</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hits</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">hits</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">suggestion</span> <span class="o">=</span> <span class="nx">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">suggestion</span> <span class="o">&amp;&amp;</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">locale_names</span> <span class="o">&amp;&amp;</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">city</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-address'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">locale_names</span><span class="p">.</span><span class="k">default</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-town'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">city</span><span class="p">.</span><span class="k">default</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-zip'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="p">(</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">postcode</span> <span class="o">||</span> <span class="p">[])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">lat</span><span class="p">,</span> <span class="nx">lng</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">$button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-locate-me'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">$latInput</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-geo-lat'</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">$lngInput</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#reverse-geo-lng'</span><span class="p">);</span>

  <span class="nx">$latInput</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">lat</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">lat</span> <span class="o">!==</span> <span class="s1">'undefined'</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">lng</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">places</span><span class="p">.</span><span class="nx">reverse</span><span class="p">({</span>
          <span class="na">aroundLatLng</span><span class="p">:</span> <span class="nx">lat</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">lng</span><span class="p">,</span>
          <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">updateForm</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">lat</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">$lngInput</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">lng</span> <span class="o">=</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">lat</span> <span class="o">!==</span> <span class="s1">'undefined'</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">lng</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">places</span><span class="p">.</span><span class="nx">reverse</span><span class="p">({</span>
          <span class="na">aroundLatLng</span><span class="p">:</span> <span class="nx">lat</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">lng</span><span class="p">,</span>
          <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">updateForm</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">lng</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">$button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$button</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Locating...'</span><span class="p">;</span>

    <span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">coords</span><span class="p">;</span>
      <span class="nx">lat</span> <span class="o">=</span> <span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
      <span class="nx">lng</span> <span class="o">=</span> <span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
      
      <span class="nx">$latInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">lat</span><span class="p">;</span>
      <span class="nx">$lngInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">lng</span><span class="p">;</span>

      <span class="nx">$button</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Locate me'</span><span class="p">;</span>
      
      <span class="nx">places</span><span class="p">.</span><span class="nx">reverse</span><span class="p">({</span>
        <span class="na">aroundLatLng</span><span class="p">:</span> <span class="nx">lat</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">lng</span><span class="p">,</span>
        <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">updateForm</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <p><strong>Important:</strong> This example does not rely on the Places.js library, but the JavaScript algoliasearch-client library. This API is only available in the JS Client for <strong>version 3.31 and above</strong>.</p> <p><strong>Note:</strong> The format of the response is slightly different from the one that is available with the Places.js library (it matches the format of the rawAnswer field in Places.js suggestions object).</p> <p><strong>Note:</strong> There are many use cases where you will want to combine the reverse geocoding API with the regular Places search. In this case, you do not need to import both the standard Places library and the JS Client, as the reverse functionality is included in the standard Places.js library. You can access the reverse endpoint programmatically using <code>placesInstance.reverse(location)</code>.</p> <h3 id=dynamic-form>Dynamic Form</h3> <p><strong>Concepts:</strong> dynamic configuration, reverse API, multiple instance.</p> <p>As we explained in the Focusing Search section, restricting the search to a single country can greatly increase the relevance of the search, because it allows Places to leverage certain specificities of that particular country. However, your userbase might not necessarily be located in a single country, which means that by default you cannot use this option to your advantage.</p> <p>In this example, we will present a way to dynamically restrict the scope of the Places search to a single country on page load, while still allowing the user to change the behaviour if he prefers less restricted search. We will also expose a way for the user to use the reverse geocoding API to fill in the details for him based on the geolocation provided by the browser. In other words, this is a more advanced implementation of the Complete Form example introduced earlier.</p> <link rel=stylesheet href="//github.com/downloads/lafeber/world-flags-sprite/flags16.css"/> <style>
  .form-inline-group {
    display: flex;
    flex-direction: row;
  }

  .form-inline-group .primary {
    flex-grow: 1;
    margin-left: 0.5em;
  }

  .form-info {
    font-size: 0.85em;
    color: rgba(0, 0, 0, 0.75);
    margin-bottom: 1em;
  }
</style> <form action="/shippit" class=form> <div class=form-inline-group> <div class=form-group> <label for=dynamic-form-hsn>House Nr.</label> <input class=form-control id=dynamic-form-hsn placeholder="ex: 123"/> </div> <div class="form-group primary"> <label for=dynamic-form-address>Address*</label> <div class=reverse-geo-controls> <input type=search class=form-control id=dynamic-form-address placeholder="Where do you live?"/> <div style="margin-left: 0.5em;"> <button id=locate-me class="btn btn-black" style="width: 150px;">Try to locate me</button> </div> </div> </div> </div> <div class=form-info> Searching in <span id=dynamic-scope>the entire world</span>. You can modify this by changing your Country of residence below.</div> <div class=form-group> <label for=dynamic-form-address2>Address 2</label> <input class=form-control id=dynamic-form-address2 placeholder="Appartment/Suite number"/> </div> <div class=form-group> <label for=dynamic-form-city>City*</label> <input class=form-control id=dynamic-form-city placeholder=City /> </div> <div class=form-group> <label for=dynamic-form-zip>ZIP code*</label> <input class=form-control id=dynamic-form-zip placeholder="ZIP code"/> </div> <div class=form-group> <label for=dynmic-form-country>Country of residence*</label> <div class=f16> <input type=search class=form-control id=dynamic-form-country placeholder=Country /> </div> </div> </form> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script> <script>
(function() {
  /* create a regular autocomplete form */
  var addressPlacesInstance = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#dynamic-form-address'),
    type: 'address',
    templates: {
      value: function(suggestion) {
        return suggestion.name;
      }
    }
  });

  addressPlacesInstance.on('change', function resultSelected(e) {
    document.querySelector('#dynamic-form-address').value = e.suggestion.name || '';
    document.querySelector('#dynamic-form-city').value = e.suggestion.city || '';
    document.querySelector('#dynamic-form-zip').value = e.suggestion.postcode || '';
    document.querySelector('#dynamic-form-country').value = e.suggestion.country || '';
  });

  /* enrich the country field with a country search */
  var countryPlacesInstance = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#dynamic-form-country'),
    type: 'country',
    templates: {
      suggestion: function(suggestion) {
        return '<i class="flag ' + suggestion.countryCode + '"></i> ' +
          suggestion.highlight.name;
      }
    }
  });

  /* If the user changes the country, update the address search configuration */
  countryPlacesInstance.on('change', function(e) {
    var country = e.suggestion.name;
    var countryCode = e.suggestion.countryCode;

    document.querySelector('#dynamic-form-country').value = country;
    document.querySelector('#dynamic-scope').textContent = country;

    addressPlacesInstance.configure({ countries: [countryCode] });
  })

  /* do a onload query for the country */
  var preferredLanguage = window.navigator.language.split('-')[0];
  algoliasearch.initPlaces('plFMJJT5O9PC','8b126ce956636c64b6e74c8b3f3d0e5e').search({
    query: '',
    aroundLatLngViaIP: true,
    type: 'country',
    hitsPerPage: 1,
    language: preferredLanguage,
  }).then(function(response) {
    var hits = response.hits;
    var suggestion = hits[0];
    var country = suggestion.locale_names[0];
    var countryCode = suggestion.country_code;

    document.querySelector('#dynamic-form-country').value = country;
    document.querySelector('#dynamic-scope').textContent = country;

    addressPlacesInstance.configure({ countries: [countryCode] });
  });

  /* -- use this instead once the method is implemented
  countryPlacesInstance.search('').then(function(suggestions) {
    var suggestion = suggestions[0];
    var country = suggestion.name;
    var countryCode = suggestion.countryCode;

    document.querySelector('#dynamic-form-country').value = country;
    document.querySelector('#dynamic-scope').textContent = country;

    addressPlacesInstance.configure({ countries: [countryCode] });
  });
  */

  var $button = document.querySelector('#locate-me');

  /* If the user does a click on the Locate me button, do a reverse query */
  $button.addEventListener('click', function(e) {
    e.preventDefault();
    $button.textContent = 'Locating...';

    navigator.geolocation.getCurrentPosition(function(response) {
      var coords = response.coords;
      lat = coords.latitude.toFixed(6);
      lng = coords.longitude.toFixed(6);

      $button.textContent = 'Try to locate me';

      addressPlacesInstance.reverse(lat + ',' + lng);
    });
  });

  /* on reverse results, update the form with the first suggestion */
  addressPlacesInstance.on('reverse', function resultSelected(e) {
    var suggestion = e.suggestions[0];
    document.querySelector('#dynamic-form-address').value = suggestion.name || '';
    document.querySelector('#dynamic-form-city').value = suggestion.city || '';
    document.querySelector('#dynamic-form-zip').value = suggestion.postcode || '';
    document.querySelector('#dynamic-form-country').value = suggestion.country || '';
    document.querySelector('#dynamic-form-hsn').value = "";
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
</pre></td><td class=rouge-code><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"//github.com/downloads/lafeber/world-flags-sprite/flags16.css"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;style&gt;</span>
  <span class="nc">.form-inline-group</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">row</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.form-inline-group</span> <span class="nc">.primary</span> <span class="p">{</span>
    <span class="nl">flex-grow</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="nl">margin-left</span><span class="p">:</span> <span class="m">0.5em</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.form-info</span> <span class="p">{</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">0.85em</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.75</span><span class="p">);</span>
    <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">1em</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/shippit"</span> <span class="na">class=</span><span class="s">"form"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-inline-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-form-hsn"</span><span class="nt">&gt;</span>House Nr.<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"dynamic-form-hsn"</span> <span class="na">placeholder=</span><span class="s">"ex: 123"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group primary"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-form-address"</span><span class="nt">&gt;</span>Address*<span class="nt">&lt;/label&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"reverse-geo-controls"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"dynamic-form-address"</span> <span class="na">placeholder=</span><span class="s">"Where do you live?"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"margin-left: 0.5em;"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"locate-me"</span> <span class="na">class=</span><span class="s">"btn btn-black"</span> <span class="na">style=</span><span class="s">"width: 150px;"</span><span class="nt">&gt;</span>Try to locate me<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-info"</span><span class="nt">&gt;</span> Searching in <span class="nt">&lt;span</span> <span class="na">id=</span><span class="s">"dynamic-scope"</span><span class="nt">&gt;</span>the entire world<span class="nt">&lt;/span&gt;</span>. You can modify this by changing your Country of residence below.<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-form-address2"</span><span class="nt">&gt;</span>Address 2<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"dynamic-form-address2"</span> <span class="na">placeholder=</span><span class="s">"Appartment/Suite number"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-form-city"</span><span class="nt">&gt;</span>City*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"dynamic-form-city"</span> <span class="na">placeholder=</span><span class="s">"City"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynamic-form-zip"</span><span class="nt">&gt;</span>ZIP code*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"dynamic-form-zip"</span> <span class="na">placeholder=</span><span class="s">"ZIP code"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"dynmic-form-country"</span><span class="nt">&gt;</span>Country of residence*<span class="nt">&lt;/label&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"f16"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"dynamic-form-country"</span> <span class="na">placeholder=</span><span class="s">"Country"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="cm">/* create a regular autocomplete form */</span>
  <span class="kd">var</span> <span class="nx">addressPlacesInstance</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-address'</span><span class="p">),</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'address'</span><span class="p">,</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">value</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">addressPlacesInstance</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">resultSelected</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-address'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-city'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-zip'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">postcode</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-country'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">country</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="cm">/* enrich the country field with a country search */</span>
  <span class="kd">var</span> <span class="nx">countryPlacesInstance</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-country'</span><span class="p">),</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'country'</span><span class="p">,</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">suggestion</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">'&lt;i class="flag '</span> <span class="o">+</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">countryCode</span> <span class="o">+</span> <span class="s1">'"&gt;&lt;/i&gt; '</span> <span class="o">+</span>
          <span class="nx">suggestion</span><span class="p">.</span><span class="nx">highlight</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="cm">/* If the user changes the country, update the address search configuration */</span>
  <span class="nx">countryPlacesInstance</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">countryCode</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestion</span><span class="p">.</span><span class="nx">countryCode</span><span class="p">;</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-country'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">country</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-scope'</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">country</span><span class="p">;</span>

    <span class="nx">addressPlacesInstance</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">countries</span><span class="p">:</span> <span class="p">[</span><span class="nx">countryCode</span><span class="p">]</span> <span class="p">});</span>
  <span class="p">})</span>

  <span class="cm">/* do a onload query for the country */</span>
  <span class="kd">var</span> <span class="nx">preferredLanguage</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nb">navigator</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">'-'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="nx">algoliasearch</span><span class="p">.</span><span class="nx">initPlaces</span><span class="p">(</span><span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span><span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">).</span><span class="nx">search</span><span class="p">({</span>
    <span class="na">query</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">aroundLatLngViaIP</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">type</span><span class="p">:</span> <span class="s1">'country'</span><span class="p">,</span>
    <span class="na">hitsPerPage</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">language</span><span class="p">:</span> <span class="nx">preferredLanguage</span><span class="p">,</span>
  <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hits</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">hits</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">suggestion</span> <span class="o">=</span> <span class="nx">hits</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">locale_names</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">countryCode</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">country_code</span><span class="p">;</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-country'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">country</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-scope'</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">country</span><span class="p">;</span>

    <span class="nx">addressPlacesInstance</span><span class="p">.</span><span class="nx">configure</span><span class="p">({</span> <span class="na">countries</span><span class="p">:</span> <span class="p">[</span><span class="nx">countryCode</span><span class="p">]</span> <span class="p">});</span>
  <span class="p">});</span>

  <span class="cm">/* -- use this instead once the method is implemented
  countryPlacesInstance.search('').then(function(suggestions) {
    var suggestion = suggestions[0];
    var country = suggestion.name;
    var countryCode = suggestion.countryCode;

    document.querySelector('#dynamic-form-country').value = country;
    document.querySelector('#dynamic-scope').textContent = country;

    addressPlacesInstance.configure({ countries: [countryCode] });
  });
  */</span>

  <span class="kd">var</span> <span class="nx">$button</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#locate-me'</span><span class="p">);</span>

  <span class="cm">/* If the user does a click on the Locate me button, do a reverse query */</span>
  <span class="nx">$button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'click'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">$button</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Locating...'</span><span class="p">;</span>

    <span class="nb">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">coords</span><span class="p">;</span>
      <span class="nx">lat</span> <span class="o">=</span> <span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
      <span class="nx">lng</span> <span class="o">=</span> <span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>

      <span class="nx">$button</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s1">'Try to locate me'</span><span class="p">;</span>

      <span class="nx">addressPlacesInstance</span><span class="p">.</span><span class="nx">reverse</span><span class="p">(</span><span class="nx">lat</span> <span class="o">+</span> <span class="s1">','</span> <span class="o">+</span> <span class="nx">lng</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>

  <span class="cm">/* on reverse results, update the form with the first suggestion */</span>
  <span class="nx">addressPlacesInstance</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'reverse'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">resultSelected</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">suggestion</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">suggestions</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-address'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-city'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">city</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-zip'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">postcode</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-country'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">country</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#dynamic-form-hsn'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> <h3 id=using-_rankinginfo>Using _rankingInfo</h3> <p><strong>Concepts:</strong> _rankingInfo, query strategy, geolocation precision.</p> <p>In this section, we will see how we can leverage <code>_rankingInfo</code> to provide additional information to our user about certain behaviours of the query strategy.</p> <p>As with any Algolia query, <code>_rankingInfo</code> will include information about how the ranking was computed based on the <code>words</code>, <code>exact</code>, <code>filters</code>, <code>nbTypos</code>, etc.<br/> However, Places also enriches the _rankingInfo with additional information based on which part of the query strategy was used to return this result.<br/> Finally, in countries where Places supports house level precision queries, it also provides some data on how precise the geolocation resolution was.</p> <p>As such, on top of the regular <code>_rankingInfo</code> fields, Places exposes the two following:</p> <ul> <li>query</li> <li>roadNumberPrecision</li> </ul> <h5 id=query>query</h5> <p>The <code>query</code> field of the <code>_rankingInfo</code> object is a reference to which query strategy was used to find this result while executing the Algolia Places Query.<br/> You can read more about the Algolia Places query strategy <a href="api-clients#query-strategy">here</a>.</p> <p>It can take 3 values depending of the strategy used to find this record:</p> <ul> <li><strong>worldwide_query</strong>: Places searched the entire world to find this record.</li> <li><strong>local_query</strong>: Places searched the country of the user to find this record.</li> <li><strong>geo_query</strong>: Places searched around the user to find this record.</li> </ul> <p>You can leverage this attribute to better understand how your constraints impact the relevance of your search.</p> <p><strong>Note:</strong> This is a very advanced feature, which will be irrelevant to most users.</p> <p><strong>Note:</strong> All searches that Places does internally still take into account the filters that you applied, so if you restrict a query to only a few countries, a worldwide query will only look into these few countries.</p> <h5 id=roadnumberprecision>roadNumberPrecision</h5> <p>The <code>roadNumberPrecision</code> field of the <code>_rankingInfo</code> object provides additional information on how precise the geolocation of the record is.</p> <p>By default, Places only offers precision up to the street level, which means that all the house numbers of a street will have the same geolocation. However, Places offers house level precision in France, if you are part of <a href="https://goo.gl/forms/8sIEGSShUm85jMLp2">the opt-in beta for this program</a>.<br/> In this case, the <code>roadNumberPrecision</code> field will return either:</p> <ul> <li><strong>exact</strong>: the house number passed in the query was found exactly in the data</li> <li><strong>closest</strong>: interpolate the position based on known datapoints</li> <li><strong>centroid</strong>: computed center of mass of the geometric area</li> </ul> <h5 id=demo>Demo</h5> <p>In this demo, we will visually show which query strategy was used to find each suggestion (on the left of the suggestion), as well as show the geolocation precision of results on the right.<br/> Remember that house level precision is only available in France, so here are some example queries that you can try to see how things work under the hood:</p> <ul> <li><code>L</code> (or any first letter that is not the first letter of a large city that is close to you)</li> <li><code>55 rue d'Amsterdam, Paris</code> (look at how there are 2 records and only one has the exact house number - 3 circles vs 2 circles)</li> </ul> <p><input type=search id=ranking-info class=form-control placeholder="Where are we going?"/></p> <script src="https://cdn.jsdelivr.net/npm/places.js@1.17.1"></script> <style>
  .suggestion {
    display: flex;
    flex-direction: row;
    box-sizing: border-box;
    align-items: center;
    width: 100%;
    padding-right: 18px;
  }

  .suggestion-icon {
    width: 20px;
    height: 20px;
    margin-right: 8px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    opacity: 0.2;
  }

  .suggestion-name {
    margin-left: 4px;
    margin-right: 4px;
    flex-grow: 0;
    flex-shrink: 0;
  }

  .suggestion-address {
    flex-grow: 1;
    flex-shrink: 1;
    margin-right: 8px;
    font-size: 0.8em;
    color: rgba(74, 74, 76, 0.5);
  }

  .suggestion-precision {
    width: 20px;
    height: 20px;
    margin-left: 8px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    animation: none;
  }
</style> <script>
(function() {
  function formatIcon(query) {
    switch (query) {
      case "worldwide_query":
        // globe icon - result found while searching in the whole world (still respects filter restrictions)
        return '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><path d="M10 0C4.48 0 0 4.48 0 10s4.48 10 10 10 10-4.48 10-10S15.52 0 10 0zM9 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L7 13v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H6V8h2c.55 0 1-.45 1-1V5h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>'
      case "local_query":
        // building icon - result found while searching in the country of the user (still respects filter restrictions)
        return '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M12 .6L2.5 6.9h18.9L12 .6zM3.8 8.2c-.7 0-1.3.6-1.3 1.3v8.8L.3 22.1c-.2.3-.3.5-.3.6 0 .6.8.6 1.3.6h21.5c.4 0 1.3 0 1.3-.6 0-.2-.1-.3-.3-.6l-2.2-3.8V9.5c0-.7-.6-1.3-1.3-1.3H3.8zm2.5 2.5c.7 0 1.1.6 1.3 1.3v7.6H5.1V12c0-.7.5-1.3 1.2-1.3zm5.7 0c.7 0 1.3.6 1.3 1.3v7.6h-2.5V12c-.1-.7.5-1.3 1.2-1.3zm5.7 0c.7 0 1.3.6 1.3 1.3v7.6h-2.5V12c-.1-.7.5-1.3 1.2-1.3z"/></svg>'
      case "geo_query":
        // pin icon - result found while searching near location of the user (still respects filter restrictions)
        return '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 14 20"><path d="M7 0C3.13 0 0 3.13 0 7c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5C5.62 9.5 4.5 8.38 4.5 7S5.62 4.5 7 4.5 9.5 5.62 9.5 7 8.38 9.5 7 9.5z"/></svg>'
      default:
        return '';
    }
  }

  function formatName (highlight) {
    var name = highlight.name;
    return name;
  }

  function formatAddress (address) {
    var suburb = address.suburb;
    var city = address.city;
    var postcode = address.postcode;
    var administrative = address.administrative;
    var country = address.country;
    return [ suburb, city, postcode, administrative, country ]
      .filter(function(v) { return !!v })
      .join(', ')
  }

  function formatPrecision (type, roadNumberPrecision) {
    if (type === 'city') {
      // 0 circle - city level precision
      return '';
    }

    switch (roadNumberPrecision) {
      case "exact":
        // 3 circles - house level precision
        return '<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">' +
  '<circle r="12" cy="16" cx="16" fill="#ddd"/>' +
  '<circle r="8" cy="16" cx="16" fill="#aaa"/>' +
  '<circle r="4" cy="16" cx="16" fill="#000"/>' +
'</svg>';
      case "closest":
        // 2 circles - house number not found - returned geolocation of the closest house number.
        return '<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">' +
  '<circle r="12" cy="16" cx="16" fill="#ddd"/>' +
  '<circle r="8" cy="16" cx="16" fill="#aaa"/>' +
'</svg>';
      default:
        // 1 circle - street level precision
        return '<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">' +
  '<circle r="12" cy="16" cx="16" fill="#ddd"/>' +
'</svg>';
    }
  }

  function formatSuggestion (suggestion) {
    var highlight = suggestion.highlight;
    var _rankingInfo = suggestion.hit._rankingInfo;
    var type = suggestion.type;

    return '<div class="suggestion">' + 
      '<span class="suggestion-icon">' + formatIcon(_rankingInfo.query) + '</span>' +
      '<span class="suggestion-name">' + formatName(highlight) + '</span>' +
      '<span class="suggestion-address">' + formatAddress(highlight) + '</span>' +
      '<span class="suggestion-precision">' + formatPrecision(type, _rankingInfo.roadNumberPrecision) + '</span>' +
    '</div>'
  }

  var placesAutocomplete = places({
    appId: 'plFMJJT5O9PC',
    apiKey: '8b126ce956636c64b6e74c8b3f3d0e5e',
    container: document.querySelector('#ranking-info'),
    templates: {
      suggestion: formatSuggestion
    }
  }).configure({
    getRankingInfo: true
  });
})();
</script> <div class=highlight><pre class="codehilite html"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
</pre></td><td class=rouge-code><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"search"</span> <span class="na">id=</span><span class="s">"ranking-info"</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">placeholder=</span><span class="s">"Where are we going?"</span> <span class="nt">/&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/places.js@1.17.1"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
  <span class="nc">.suggestion</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">row</span><span class="p">;</span>
    <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="nl">padding-right</span><span class="p">:</span> <span class="m">18px</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.suggestion-icon</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nl">margin-right</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
    <span class="nl">flex-shrink</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.2</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.suggestion-name</span> <span class="p">{</span>
    <span class="nl">margin-left</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
    <span class="nl">margin-right</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
    <span class="nl">flex-grow</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">flex-shrink</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.suggestion-address</span> <span class="p">{</span>
    <span class="nl">flex-grow</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="nl">flex-shrink</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="nl">margin-right</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">0.8em</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">74</span><span class="p">,</span> <span class="m">74</span><span class="p">,</span> <span class="m">76</span><span class="p">,</span> <span class="m">0.5</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nc">.suggestion-precision</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nl">margin-left</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
    <span class="nl">flex-shrink</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="nl">animation</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">formatIcon</span><span class="p">(</span><span class="nx">query</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">query</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s2">"worldwide_query"</span><span class="p">:</span>
        <span class="c1">// globe icon - result found while searching in the whole world (still respects filter restrictions)</span>
        <span class="k">return</span> <span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"&gt;&lt;path d="M10 0C4.48 0 0 4.48 0 10s4.48 10 10 10 10-4.48 10-10S15.52 0 10 0zM9 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L7 13v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H6V8h2c.55 0 1-.45 1-1V5h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/&gt;&lt;/svg&gt;'</span>
      <span class="k">case</span> <span class="s2">"local_query"</span><span class="p">:</span>
        <span class="c1">// building icon - result found while searching in the country of the user (still respects filter restrictions)</span>
        <span class="k">return</span> <span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"&gt;&lt;path d="M12 .6L2.5 6.9h18.9L12 .6zM3.8 8.2c-.7 0-1.3.6-1.3 1.3v8.8L.3 22.1c-.2.3-.3.5-.3.6 0 .6.8.6 1.3.6h21.5c.4 0 1.3 0 1.3-.6 0-.2-.1-.3-.3-.6l-2.2-3.8V9.5c0-.7-.6-1.3-1.3-1.3H3.8zm2.5 2.5c.7 0 1.1.6 1.3 1.3v7.6H5.1V12c0-.7.5-1.3 1.2-1.3zm5.7 0c.7 0 1.3.6 1.3 1.3v7.6h-2.5V12c-.1-.7.5-1.3 1.2-1.3zm5.7 0c.7 0 1.3.6 1.3 1.3v7.6h-2.5V12c-.1-.7.5-1.3 1.2-1.3z"/&gt;&lt;/svg&gt;'</span>
      <span class="k">case</span> <span class="s2">"geo_query"</span><span class="p">:</span>
        <span class="c1">// pin icon - result found while searching near location of the user (still respects filter restrictions)</span>
        <span class="k">return</span> <span class="s1">'&lt;svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 14 20"&gt;&lt;path d="M7 0C3.13 0 0 3.13 0 7c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5C5.62 9.5 4.5 8.38 4.5 7S5.62 4.5 7 4.5 9.5 5.62 9.5 7 8.38 9.5 7 9.5z"/&gt;&lt;/svg&gt;'</span>
      <span class="k">default</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">''</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">formatName</span> <span class="p">(</span><span class="nx">highlight</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">highlight</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">name</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">formatAddress</span> <span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">suburb</span> <span class="o">=</span> <span class="nx">address</span><span class="p">.</span><span class="nx">suburb</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">city</span> <span class="o">=</span> <span class="nx">address</span><span class="p">.</span><span class="nx">city</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">postcode</span> <span class="o">=</span> <span class="nx">address</span><span class="p">.</span><span class="nx">postcode</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">administrative</span> <span class="o">=</span> <span class="nx">address</span><span class="p">.</span><span class="nx">administrative</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">country</span> <span class="o">=</span> <span class="nx">address</span><span class="p">.</span><span class="nx">country</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">[</span> <span class="nx">suburb</span><span class="p">,</span> <span class="nx">city</span><span class="p">,</span> <span class="nx">postcode</span><span class="p">,</span> <span class="nx">administrative</span><span class="p">,</span> <span class="nx">country</span> <span class="p">]</span>
      <span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">!!</span><span class="nx">v</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">', '</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">formatPrecision</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">roadNumberPrecision</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">'city'</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 0 circle - city level precision</span>
      <span class="k">return</span> <span class="s1">''</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nx">roadNumberPrecision</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s2">"exact"</span><span class="p">:</span>
        <span class="c1">// 3 circles - house level precision</span>
        <span class="k">return</span> <span class="s1">'&lt;svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"&gt;'</span> <span class="o">+</span>
  <span class="s1">'&lt;circle r="12" cy="16" cx="16" fill="#ddd"/&gt;'</span> <span class="o">+</span>
  <span class="s1">'&lt;circle r="8" cy="16" cx="16" fill="#aaa"/&gt;'</span> <span class="o">+</span>
  <span class="s1">'&lt;circle r="4" cy="16" cx="16" fill="#000"/&gt;'</span> <span class="o">+</span>
<span class="s1">'&lt;/svg&gt;'</span><span class="p">;</span>
      <span class="k">case</span> <span class="s2">"closest"</span><span class="p">:</span>
        <span class="c1">// 2 circles - house number not found - returned geolocation of the closest house number.</span>
        <span class="k">return</span> <span class="s1">'&lt;svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"&gt;'</span> <span class="o">+</span>
  <span class="s1">'&lt;circle r="12" cy="16" cx="16" fill="#ddd"/&gt;'</span> <span class="o">+</span>
  <span class="s1">'&lt;circle r="8" cy="16" cx="16" fill="#aaa"/&gt;'</span> <span class="o">+</span>
<span class="s1">'&lt;/svg&gt;'</span><span class="p">;</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="c1">// 1 circle - street level precision</span>
        <span class="k">return</span> <span class="s1">'&lt;svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"&gt;'</span> <span class="o">+</span>
  <span class="s1">'&lt;circle r="12" cy="16" cx="16" fill="#ddd"/&gt;'</span> <span class="o">+</span>
<span class="s1">'&lt;/svg&gt;'</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">function</span> <span class="nx">formatSuggestion</span> <span class="p">(</span><span class="nx">suggestion</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">highlight</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">highlight</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">_rankingInfo</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">hit</span><span class="p">.</span><span class="nx">_rankingInfo</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">suggestion</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>

    <span class="k">return</span> <span class="s1">'&lt;div class="suggestion"&gt;'</span> <span class="o">+</span> 
      <span class="s1">'&lt;span class="suggestion-icon"&gt;'</span> <span class="o">+</span> <span class="nx">formatIcon</span><span class="p">(</span><span class="nx">_rankingInfo</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;'</span> <span class="o">+</span>
      <span class="s1">'&lt;span class="suggestion-name"&gt;'</span> <span class="o">+</span> <span class="nx">formatName</span><span class="p">(</span><span class="nx">highlight</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;'</span> <span class="o">+</span>
      <span class="s1">'&lt;span class="suggestion-address"&gt;'</span> <span class="o">+</span> <span class="nx">formatAddress</span><span class="p">(</span><span class="nx">highlight</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;'</span> <span class="o">+</span>
      <span class="s1">'&lt;span class="suggestion-precision"&gt;'</span> <span class="o">+</span> <span class="nx">formatPrecision</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">_rankingInfo</span><span class="p">.</span><span class="nx">roadNumberPrecision</span><span class="p">)</span> <span class="o">+</span> <span class="s1">'&lt;/span&gt;'</span> <span class="o">+</span>
    <span class="s1">'&lt;/div&gt;'</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">placesAutocomplete</span> <span class="o">=</span> <span class="nx">places</span><span class="p">({</span>
    <span class="na">appId</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_APP_ID&gt;'</span><span class="p">,</span>
    <span class="na">apiKey</span><span class="p">:</span> <span class="s1">'&lt;YOUR_PLACES_API_KEY&gt;'</span><span class="p">,</span>
    <span class="na">container</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'#ranking-info'</span><span class="p">),</span>
    <span class="na">templates</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">suggestion</span><span class="p">:</span> <span class="nx">formatSuggestion</span>
    <span class="p">}</span>
  <span class="p">}).</span><span class="nx">configure</span><span class="p">({</span>
    <span class="na">getRankingInfo</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">});</span>
<span class="p">})();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></pre></div> </div> </div> </section> <script src="js/documentation-layout-caf8b96a.js"></script> <section class=ac-footer> <div class=ac-footer-container> <p class=ac-footer-links> Code licensed under <a class=ac-footer-link-item href='https://github.com/algolia/places/blob/master/LICENSE'>MIT</a> <br> <a class=ac-footer-link-item href='https://github.com/algolia/places/'>Github</a> <a class=ac-footer-link-item href='https://github.com/algolia/places/issues'>Issues</a> <a class=ac-footer-link-item href='https://www.algolia.com/policies/privacy'>Privacy policy</a> </p> </div> <div class='ac-footer-container ac-footer-brand'> <p>This project is part of</p> <img class=ac-footer-brand-icon src='images/svg/community-badge-271b6a52.svg'> <figure> <img class=ac-footer-brand-logo src='https://res.cloudinary.com/hilnmyskv/image/upload/v1484219849/algolia-community-logo-words-darkbg.svg'> <figcaption>Algolia Community</figcaption> </figure> <a class='ac-footer-btn ac-footer-btn-cta' href='https://community.algolia.com/'>See More</a> <span class='ac-icon ac-icon-love-dark'></span> </div> <p class=ac-footer-version>Latest version: 1.17.1</p> <div class=ac-footer-actions> <div class=footer-container> <p>Build unique search experiences with Algolia</p> <a class='ac-footer-btn ac-footer-btn-ghost-grey' href='https://www.algolia.com/why?utm_medium=social-owned&amp;utm_source=places%20website&amp;utm_campaign=homepage&amp;utm_term=why'> See Why <span class=ac-icon-triangle></span> </a> <a class='ac-footer-btn ac-footer-btn-ghost-pink' href='https://www.algolia.com/users/sign_up?utm_medium=social-owned&amp;utm_source=places%20website&amp;utm_campaign=homepage&amp;utm_term=get_started'>Get Started For Free</a> </div> </div> </section> <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-N8JP8G" height=0 width=0 style="display:none;visibility:hidden"></iframe></noscript> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N8JP8G');</script> <script src="js/common-1dec9348.js"></script> </body> </html>